function NSUtil()
{
	this.__sheetId = "nsStyle";
	this.KEYCODE = {BACKSPACE:8, TAB:9, ENTER:13, SHIFT:16, CTRL:17, ALT:18, ESC:27, LEFT:37, UP:38, RIGHT:39, DOWN:40};
	this.ANIMATIONDELAY = 10;
	//for nsMenu and nsPinTip
	this.POS_TOP = "top";
	this.POS_BOTTOM = "bottom";
	this.POS_LEFT = "left";
	this.POS_RIGHT = "right";
	this.POS_TOPLEFT = "top-left";
	this.POS_TOPRIGHT = "top-right";
	this.POS_BOTTOMLEFT = "bottom-left";
	this.POS_BOTTOMRIGHT = "bottom-right";
};

NSUtil.prototype.getElement = function (element)
{
	if(element)
	{
		if(this.isObject(element))
		{
			return element;
		}
		else if(element.length > 0)
		{
			return document.getElementById(element);
		}
	}
	
	return null;
};

NSUtil.prototype.getWebComponentElement = function (element)
{
	if(element && element["__impl4cf1e782hg__"])
	{
		return element["__impl4cf1e782hg__"];
	}
	return element;
};

NSUtil.prototype.hasAttribute = function (element,attributeName)
{
	if(element && attributeName && element["hasAttribute"])
	{
		return (element.hasAttribute(attributeName) || element.hasAttribute("data-" + attributeName)); 
	}
	return false;
};

NSUtil.prototype.getAttribute = function (element,attributeName)
{
	if(element && attributeName && element["hasAttribute"])
	{
		return (element.hasAttribute(attributeName) ? element.getAttribute(attributeName) : element.getAttribute("data-" + attributeName)); 
	}
	return null;
};

NSUtil.prototype.removeAttribute = function (element,attributeName)
{
	if(element && attributeName && element["hasAttribute"])
	{
		return (element.hasAttribute(attributeName) ? element.removeAttribute(attributeName) : element.removeAttribute("data-" + attributeName)); 
	}
	return null;
};

NSUtil.prototype.createDiv = function (id,styleName)
{
    var div = this.createElement("div",id,styleName);
    return div;
};

NSUtil.prototype.createElement = function(type,id,styleName)
{
    var element = document.createElement(type);
    if(id)
    {
    	element.setAttribute("id",id);
    }
    if(styleName)
    {
    	element.className = styleName;   
    }
    return element;
};

NSUtil.prototype.setDivVisibility = function (id,isVisible)
{
    var div = document.getElementById(id);
    if(div)
    {
        if(isVisible)
        {
            div.style.display = "block";
        }
        else
        {
            div.style.display = "none";
        }
    }
};

NSUtil.prototype.removeDiv = function (id)
{
    var div = document.getElementById(id);
    if (div)
    {
        var parent = div.parentNode;
        if(parent)
        {
            parent.removeChild(div);
        }
    }
};

/*Utility Methods */
NSUtil.prototype.getKeys = function (object) 
{
    var keys = [];
    for (var property in object)
    {
    	keys.push(property);
    }
    return keys;
};

NSUtil.prototype.getValues = function (object)
{
	var values = [];
	for (var property in object)
	{
		values.push(object[property]);
	}
	return values;
};

/*NSUtil.prototype.mergeObjects = function(source,destination,copyFunction) 
{
	var key = null; 
	var temp = null;
	var empty = {};
	for(key in source)
	{
		// the (!(key in empty) || empty[key] !== temp) condition avoids copying properties in "source"
		// inherited from Object.prototype.	 For example, if destination has a custom toString() method,
		// don't overwrite it with the toString() method that source inherited from Object.prototype
		temp = source[key];
		if(!(key in destination) || (destination[key] !== temp && (!(key in empty) || empty[key] !== temp)))
		{
			destination[key] = copyFunction ? copyFunction(temp) : temp;
		}
	}
	return destination;
};*/
   
NSUtil.prototype.cloneObject = function(objSource,deepCopy) 
{
	if(!objSource || typeof objSource != "object" || Object.prototype.toString.call(objSource) === "[object Function]")
	{
		// null, undefined, any non-object, or function
		return objSource;	// anything
	}
	if(objSource.nodeType && "cloneNode" in objSource)
	{
		// DOM Node
		return objSource.cloneNode(true); // Node
	}
	if(objSource instanceof Date)
	{
		// Date
		return new Date(objSource.getTime());	// Date
	}
	if(objSource instanceof RegExp)
	{
		// RegExp
		return new RegExp(objSource);   // RegExp
	}
	if(objSource instanceof Array)
	{
		var arrClone = [];
		var length = objSource.length;
	    for (var count = 0; count < length; count++) 
	    {
	        var item = objSource[count];
	        var obj = this.cloneObject(item,deepCopy);
	        arrClone.push(obj);
	    }
	    return arrClone;
		// we don't clone functions for performance reasons
		//		}else if(d.isFunction(objSource)){
		//			// function
		//			r = function(){ return objSource.apply(this, arguments); };
	}
	// generic objects
	var objClone = {};
	var clonedItem = null;
	for (var key in objSource) 
	{
		if(deepCopy)
		{
			clonedItem = this.cloneObject(objSource[key],deepCopy);
		}
		else
		{
			clonedItem = objSource[key];
		}
		objClone[key] = clonedItem;
    }
	return objClone;
	/*var constructor = objSource.constructor ? new objSource.constructor() : {};
	return this.mergeObjects(constructor, objSource, this.cloneObject);*/
};

NSUtil.prototype.copyElement = function(sourceElement,destinationElement)
{
	if(sourceElement)
	{
		if(destinationElement)
		{
			destinationElement.innerHTML = sourceElement.innerHTML;
		}
		else
		{
			destinationElement = sourceElement.cloneNode(true);
		}
		for (var count = 0; count < sourceElement.attributes.length; count++) 
		{
			var attr = sourceElement.attributes.item(count);
			destinationElement.setAttribute(attr.nodeName, attr.nodeValue);
		}
		//destinationElement.style.cssText = sourceElement.style.cssText;
	}
	return destinationElement;
};

NSUtil.prototype.swapArrayItems = function(arrInput,indFirst,indSecond) 
{
	if(arrInput && arrInput.length > indFirst && arrInput.length > indSecond)
	{
		var objTemp = arrInput[indFirst];
		arrInput[indFirst] = arrInput[indSecond];
		arrInput[indSecond] = objTemp;
		
		return true;
	}
	return false;
};

NSUtil.prototype.moveArrayItem = function(arrInput,sourceIndex,destinationIndex) 
{
	if(arrInput && arrInput.length > destinationIndex && arrInput.length > sourceIndex && destinationIndex > -1 && sourceIndex > -1)
	{
		// Remove the element from the array
		var removedElement = arrInput.splice(sourceIndex, 1)[0];
		// At destinationIndex, remove 0 elements, insert the removedElement
		arrInput.splice(destinationIndex, 0,removedElement);
		return true;
	}
	return false;
};

NSUtil.prototype.isObject = function (refObject)
{
	if (typeof refObject === 'object' && refObject !== null) 
	{
	    return true;
	} 
	return false;
};

NSUtil.prototype.isElement = function (element)
{
    return (element && "nodeType" in element && element.nodeType === 1);
};

NSUtil.prototype.isElementOfType = function (element,tagName)
{
	if(element && tagName)
    {
        if(element.tagName && element.tagName.toLowerCase() === tagName.toLowerCase())
        {
        	return true;
        }
    }
	return false;
};

NSUtil.prototype.isArray = function (refArr) 
{
    return refArr != null && typeof refArr == "object" &&
      "splice" in refArr && "join" in refArr;
};

NSUtil.prototype.isVariable = function (variableName) 
{
	return !this.isUndefined(window[variableName]); 
};

NSUtil.prototype.insertAfterElement = function(referenceElement,insertElement) 
{
	if(referenceElement && insertElement)
	{
		var parentElement = this.getWebComponentElement(referenceElement.parentNode);
		if(parentElement)
		{
			referenceElement = this.getWebComponentElement(referenceElement);
			insertElement = this.getWebComponentElement(insertElement);
			parentElement.insertBefore(insertElement,referenceElement);
			parentElement.insertBefore(referenceElement,insertElement);
		}
	}
};

NSUtil.prototype.getFunction = function (functionInstance)
{
	if(functionInstance)
	{
		if (typeof functionInstance === "string" || functionInstance instanceof String)
		{
			if(this.isFunction(functionInstance))
			{
				functionInstance = window[functionInstance];
			}
		}
	}
	return functionInstance;
};

NSUtil.prototype.callFunction = function (functionName) 
{
	var returnValue = null;
	if (typeof window[functionName] === "function") 
	{
		returnValue = window[functionName]();
	}
	return returnValue;
};

NSUtil.prototype.callFunctionFromString = function (functionString,replaceParameterFunction)
{
	var returnValue = null;
	if(functionString)
	{
		var functionName = null;
		var arrParameter = null;
		if(functionString.indexOf("(") > -1)
		{
			var param = functionString.split("(");
			if(param && param.length > 0)
			{
				functionName = param[0];
				var parameter = param[1];
				if(parameter && parameter.charAt(parameter.length - 1) === ")")
				{
					parameter = parameter.substring(0,parameter.length - 1);
					var arrParam = parameter.split(",");
					if(arrParam && arrParam.length > 0)
					{
						arrParameter = arrParam;
					}
				}
			}
		}
		else
		{
			functionName = functionString;
		}
		if(this.isFunction(functionName))
		{
			if(!arrParameter || arrParameter.length === 0)
			{
				returnValue = this.callFunction(functionName);
			}
			else
			{
				if(replaceParameterFunction)
				{
					for(var count = 0;count < arrParameter.length;count++)
					{
						 var newValue = replaceParameterFunction(arrParameter[count]);
						 if(!this.isUndefined(newValue))
						 {
							 arrParameter[count] = newValue;
						 }
					}	
				}
				switch (arrParameter.length) 
				{
				    case 1:
				    	returnValue = window[functionName](arrParameter[0]);
				        break;
				    case 2:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1]);
				        break;
				    case 3:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2]);
				        break;
				    case 4:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3]);
				        break;
				    case 5:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3],arrParameter[4]);
				        break;
				    case 6:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3],arrParameter[4],arrParameter[5]);
				        break;
				    case 7:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3],arrParameter[4],arrParameter[5],arrParameter[6]);
				        break;
				    case 8:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3],arrParameter[4],arrParameter[5],arrParameter[6],arrParameter[7]);
				        break;
				    case 9:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3],arrParameter[4],arrParameter[5],arrParameter[6],arrParameter[7],arrParameter[8]);
				        break;
				    case 10:
				    	returnValue = window[functionName](arrParameter[0],arrParameter[1],arrParameter[2],arrParameter[3],arrParameter[4],arrParameter[5],arrParameter[6],arrParameter[7],arrParameter[8],arrParameter[9]);
				        break;
				}
			}
		}
	}
	return returnValue;
};

NSUtil.prototype.isElementInDOM = function(node) 
{
	return (node === document.body) ? false : document.body.contains(node);
};

NSUtil.prototype.isElementVisible = function(element) 
{
	 if(element)
	 {
		 if(!element.offsetParent)
		 {
			 return false;
		 }
		 var style = window.getComputedStyle(element);
		 if(style.display === "none" || style.visibility  === "hidden")
		 {
			 return false;
		 }
	 }
	 return true;
};

NSUtil.prototype.isFunction = function(refFunction) 
{
    if(refFunction && ((typeof refFunction == "function") || (typeof window[refFunction] === "function")))
    {
    	return true;
    }
    return false;
};

NSUtil.prototype.isString = function(object) 
{
    return typeof object == "string";
};

NSUtil.prototype.isNumber = function(object) 
{
    return typeof object == "number";
};

NSUtil.prototype.isBoolean = function(object) 
{
    return typeof object == "boolean";
};
  
NSUtil.prototype.isUndefined = function(object) 
{
    return typeof object == "undefined";
};

NSUtil.prototype.isUndefinedOrNull = function(object) 
{
    return (this.isUndefined(object) || object === null);
};

NSUtil.prototype.isStringValid = function(objString) 
{
    if(!objString || objString === "")
    {
    	return false;
    }
    return true;
};

NSUtil.prototype.toCamelCase = function(objString,isFirstLetterCapital) 
{
	if(this.isString(objString))
	{
		return ((isFirstLetterCapital ? "-" : "") + objString).replace(/-+([^-])/g, function(str, char) 
				{
		    		return char.toUpperCase();
				});
	}
	return objString;
};

/*
 * 1001 - function validation failure
 * 1002 - function return Parameter is not valid
 */
NSUtil.prototype.throwException = function (exceptionCode,exceptionName,exceptionDetails)
{
	function nsException() 
	{
		   this.code = exceptionCode;
		   this.name = exceptionName;
		   this.details = exceptionDetails;
		   this.toString = function() 
		   {
		      return "Exception Occured with Code::" +  this.code + " and Details " +  this.name + "::" + this.details;
		   };
	}
    //alert("Error Occured with details code: " + exceptionCode + ",name: " + exceptionName + ",details: " + exceptionDetails);
    throw new nsException();
};

//other values of navigator.appName is "Netscape","Opera"
//From IE 11 navigator.appName returns "Netscape" instead of "Microsoft Internet Explorer"
//and From IE 11 it follows standard API.
NSUtil.prototype.isBrowserIE = function ()
{
    if(navigator && ((navigator.appName && navigator.appName == "Microsoft Internet Explorer") || (navigator.userAgent && navigator.userAgent.match(/Trident/))))
    {
        return true;
    }
    return false;
};

NSUtil.prototype.getBrowser = function ()
{
	var objBrowser = {code:null,name:null,version:null,appName:null,appCodeName:null,platform:null};
	var userAgent = window.navigator.userAgent;
	if(userAgent.indexOf("Chrome") != -1) 
	{
		objBrowser.code = "chrome";
		objBrowser.name = "Google Chrome";
	} 
	else if(userAgent.indexOf("Firefox") != -1) 
	{
		objBrowser.code = "firefox";
		objBrowser.name = "Mozilla Firefox";
	} 
	else if(userAgent.indexOf("Opera")!=-1) 
	{
		objBrowser.code = "opera";
		objBrowser.name = "Opera";
	}
	//for IE version 6 to 11
	else if(userAgent.indexOf('MSIE')!==-1 || navigator.appVersion.indexOf('Trident/') > 0)
	{
		objBrowser.code = "ie";
		objBrowser.name = "Internet Explorer"
	}
	//for IE 12
	else if(/x64|x32/ig.test(userAgent))
	{
		objBrowser.code = "ie";
		objBrowser.name = "Internet Explorer 12";
	}
	else if (userAgent.indexOf("Safari")!=-1) 
	{
		objBrowser.code = "safari";
		objBrowser.name = "Safari";
	} 
	else 
	{
		objBrowser.code = "-1";
		objBrowser.name = "Unknown Browser";
	}
	objBrowser.version = navigator.appVersion;
	objBrowser.appName = navigator.appName;
	objBrowser.appCodeName = navigator.appCodeName;
	objBrowser.platform = navigator.platform;
	
	return objBrowser;
};

NSUtil.prototype.findParentBySelector = function (element,parentSelector)
{
    if(element && parentSelector)
    {
    	var matchesFn = null;
    	var parent = null;
    	['matches','webkitMatchesSelector','mozMatchesSelector','msMatchesSelector','oMatchesSelector'].some(function(callback) 
    	{
            if (typeof document.body[callback] == 'function') 
            {
                matchesFn = callback;
                return true;
            }
            return false;
        });

        // traverse parents
        while (element) 
        {
            parent = element.parentElement;
            if (parent && parent[matchesFn](parentSelector)) 
            {
                return parent;
            }
            element = parent;
        }
    }
    return null;
};

//navigates to the DOM Heirarchy to find the nearest parent of the specified HTML tag 
NSUtil.prototype.findParent = function (element,parentTag)
{
    if(element && parentTag)
    {
        while (element && element.tagName && element.tagName.toLowerCase() != parentTag.toLowerCase())
        {
            element = element.parentNode;
        }
        if(element && element.tagName && element.tagName.toLowerCase() === parentTag.toLowerCase())
        {
        	return element;
        }
    }
    return null;
};

NSUtil.prototype.findChild = function (element,childTag)
{
    if(element && childTag && element.getElementsByTagName(childTag).length > 0)
    {
        return element.getElementsByTagName(childTag)[0];
    }  
    return null;
};

NSUtil.prototype.getStyleValue = function(element,styleProperty,getOrignalValue)
{
	var propertyValue = null;
	if(element && styleProperty)
	{
		element = this.getElement(element);
		getOrignalValue = this.isUndefined(getOrignalValue) ? true : getOrignalValue;
		var getValue = function(styleProp)
		{
			var retValue = null;
			if(element.currentStyle)
		    {
				retValue = element.currentStyle[styleProp];
		    }
			else if(window.getComputedStyle)
			{
				retValue = window.getComputedStyle(element, null).getPropertyValue(styleProp);
			}
			return retValue;
		};
		if(styleProperty === "display")
		{
			propertyValue = getValue(styleProperty);
		}
		else
		{
			var displayValue = null;
			if(getOrignalValue)
			{
				displayValue = getValue("display");
				element.style.display = "none";
			}
			propertyValue = getValue(styleProperty);
			if(getOrignalValue)
			{
				element.style.display = displayValue ? displayValue: "";
			}
		}
	 }
	 return propertyValue;
};

NSUtil.prototype.getControlValue = function(control)
{
	if(control)
	{
		 if(control.tagName == "INPUT") 
		 {
            if(control.type == "text") 
            {
            	return control.value;
            }
            if(control.type == "checkbox") 
            {
            	return control.checked;
            }
            if(control.type == "radio") 
            {
            	return control.checked;
            }
         }  
         if(control.tagName == "SELECT") 
         {
        	 return control.value;
         }
	}
	return null;
};

NSUtil.prototype.setControlValue = function(control,value)
{
	var retValue = null;
	if(control)
	{
		 if(control.tagName == "INPUT") 
		 {
            if(control.type == "text") 
            {
            	retValue = value;
            	control.value = value;
            }
            if(control.type == "checkbox") 
            {
            	retValue = Boolean.parse(value);
            	control.checked = retValue;
            }
            if(control.type == "radio") 
            {
            	retValue = Boolean.parse(value);
            	control.checked = retValue;
            }
         }  
         if(control.tagName == "SELECT") 
         {
        	 retValue = value;
        	 control.value = value;
         }
	}
	return retValue;
};

//returns the top y coordinate of the given div used while listening to scrolling events(vertical scrolling)
NSUtil.prototype.scrollTop = function (div)
{
	 if(div)
	 {
	    return (div.scrollHeight - div.clientHeight);
	 }
	 return -1;
};

//returns the top x coordinate of the given div used while listening to scrolling events(horizontal scrolling)
NSUtil.prototype.scrollLeft = function (div)
{
	 if(div)
	 {
		 return (div.scrollWidth - div.clientWidth);
	 }
	 return -1;
};

//adds Style class to an element's styles list 
NSUtil.prototype.addStyleClass = function (element,styleClass)
{
    if(element && styleClass && styleClass.length > 0)
    {
        if(element.classList)
        {
            if(!this.hasStyleClass(element,styleClass))
            {
            	element.classList.add(styleClass);
            }
        }
        else
        {
            if(!this.hasStyleClass(element,styleClass))
            {
            	if(element.className instanceof SVGAnimatedString)
    			{
            		element.setAttribute('class', element.getAttribute('class') + ' ' + styleClass);
    			}
            	else
            	{
            		element.className += " " + styleClass;
            	}
            }
        }
    }
};

//returns true if a Style class is present in element's styles list
NSUtil.prototype.hasStyleClass = function (element,styleClass)
{
    if(element && styleClass && styleClass.length > 0)
    {
    	try
    	{
    		if(!element.classList)
            {
    			if(element.className instanceof SVGAnimatedString)
    			{
    				return new RegExp('(\\s|^)' + styleClass + '(\\s|$)').test(element.getAttribute('class'));
    			}
    			else
    			{
    				return (element.className.indexOf(" " + styleClass) > -1);
    			}
            }
            else if(element.classList.contains)
            {
            	return element.classList.contains(styleClass);
            }
    	}
    	catch(error)
    	{
    		
    	}
        
    }
    return false;
};

//removes Style class from an element's styles list
NSUtil.prototype.removeStyleClass = function(element,styleClass)
{
    if(element && styleClass && styleClass.length > 0)
    {
        if(element.classList)
        {
        	element.classList.remove(styleClass);
        }
        else if(element.className)
        {
        	if(element.className instanceof SVGAnimatedString)
			{
        		var removedClass = element.getAttribute('class').replace(new RegExp('(\\s|^)' + styleClass + '(\\s|$)', 'g'), '$2');
        		if (this.hasStyleClass(styleClass)) 
        		{
        		   this.setAttribute('class', removedClass);
        		}
			}
        	else
        	{
        		element.className = element.className.replace(styleClass,"");
        	}
        }
    }
};

NSUtil.prototype.toggleStyleClass = function(element,styleClass)
{
    if(element && styleClass && styleClass.length > 0)
    {
   	 	this.hasStyleClass(element,styleClass) ? this.removeStyleClass(element,styleClass) : this.addStyleClass(element,styleClass); 
    }
};

//change Style class from an element's styles list
NSUtil.prototype.changeStyleClass = function (element,oldStyleClass,newStyleClass)
{
    if(element && oldStyleClass && oldStyleClass.length > 0 && newStyleClass && newStyleClass.length > 0)
    {
        if(element.classList)
        {
        	element.classList.remove(oldStyleClass);
            if(!element.classList.contains(newStyleClass))
            {
                element.classList.add(newStyleClass);
            }
        }
        else
        {
        	if(element.className instanceof SVGAnimatedString)
			{
        		this.removeStyleClass(element,oldStyleClass);
        		this.addStyleClass(element,newStyleClass);
			}
        	else if(element.className)
        	{
        		element.className = element.className.replace(oldStyleClass,newStyleClass);
        	}
        }
    }
};

NSUtil.prototype.addEvent = (document.addEventListener) ? 
function(element, eventType, listener)
{
	if(element)
	{
		element.addEventListener(eventType, listener);
	}
} :
function(element, eventType, listener)
{
	if(element)
	{
		element.attachEvent("on" + eventType, listener);
	}
};

NSUtil.prototype.removeEvent = (document.removeEventListener) ? 
function(element, eventType, listener)
{
	if(element)
	{
		element.removeEventListener(eventType, listener);
	}
} :
function(element, eventType, listener)
{
	if(element)
	{
		element.detachEvent("on" + eventType, listener);
	}
}; 

NSUtil.prototype.dispatchEvent = function(element,eventType,data,param,bubbles,cancelable)
{
	 var cancelled = false;
	 var event = null;
	 if(this.isUndefined(bubbles) || bubbles === null)
	 {
		 bubbles = true;
	 }
	 if(this.isUndefined(cancelable) || cancelable === null)
	 {
		 cancelable = false;
	 }
	 if (document.createEvent) 
	 {
	    event = document.createEvent("HTMLEvents",{ "detail": data});
	    event.initEvent(eventType, bubbles, cancelable);
	    try
		{
			var tempEvent = document.createEvent("HTMLEvents");
			tempEvent.initEvent("nsPing", false, false);
			element.dispatchEvent(tempEvent);
		}
		catch(error)
		{
			event = event["__impl4cf1e782hg__"];
		}
	 } 
	 else 
	 {
	    event = document.createEventObject();
	    event.eventType = eventType;
	    event.cancelBubble = !bubbles;
	    event.cancelable = cancelable;
	    try
		{
	    	var tempEvent = document.createEventObject();
	    	tempEvent.eventType = "nsPing";
	    	tempEvent.cancelBubble = true;
	    	tempEvent.cancelable = false;
	    	element.fireEvent("on" + tempEvent.eventType, tempEvent);
		}
		catch(error)
		{
			event = event["__impl4cf1e782hg__"];
		}
	 }
	 event.eventName = eventType;
	 event.detail = data;
	 if(param)
	 {
		 for (var key in param) 
		 {
			 if(param.hasOwnProperty(key)) 
			 {
				 event[key] = param[key];
			 } 
		 }   
	 }
	 if(document.createEvent) 
	 {
		cancelled = !element.dispatchEvent(event);
	 } 
	 else 
	 {
		cancelled = element.fireEvent("on" + event.eventType, event);
	 }
	 return cancelled;
};

//returns event for all kind of browser
NSUtil.prototype.getEvent = function (event)
{
	if (!event)
	{
		event = window.event;
	}
	if (event.targetTouches) 
	{
		event = event.targetTouches.item(0);
    } 
	else if (event.originalEvent && event.originalEvent.targetTouches) 
	{
		event = event.originalEvent.targetTouches.item(0);
    }
	return event;
};

//returns target for all kind of browser
NSUtil.prototype.getTarget = function (event)
{
	event = this.getEvent(event);
	var target = event.target ? event.target : event.srcElement;
	return target;
};

//preventDefault for all kind of browser
NSUtil.prototype.preventDefault = function(event)
{
	event = this.getEvent(event);
	if(event.preventDefault) 
	{
	   event.preventDefault();
	}
	else
	{
	   event.returnValue = false;
	}
};

NSUtil.prototype.preventDefaultForScrollKeys = function(event)
{
	// left: 37, up: 38, right: 39, down: 40,
	var objKeys = {37: 1, 38: 1, 39: 1, 40: 1};
	event = this.getEvent(event);
	if (objKeys[event.keyCode]) 
	{
        this.util.preventDefault(event);
        return false;
    }
};

//reference: http://www.broofa.com/Tools/Math.uuid.js
NSUtil.prototype.getUniqueId = function () 
{
    var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");
    var uuid = new Array(36);
    var rnd=0;
    var r;
    
    for (var count = 0; count < 36; count++) 
    {
      if (count==14) 
      {
        uuid[count] = '4';
      } 
      else 
      {
        if (rnd <= 0x02) 
        {
        	rnd = 0x2000000 + (Math.random()*0x1000000) | 0;
        }
        r = rnd & 0xf;
        rnd = rnd >> 4;
        uuid[count] = chars[(count == 19) ? (r & 0x3) | 0x8 : r];
      }
    }
    return uuid.join('');
 };
 
 NSUtil.prototype.addCSSClassInDOM = function(arrClassName,arrCSSText,checkExisting,doc)
 {
	 if(!doc)
     {
		 doc = document; 
     }
	 if(doc.styleSheets && arrClassName && arrCSSText && arrCSSText.length === arrCSSText.length)
	 {
		 checkExisting = this.isUndefined(checkExisting) ? true : checkExisting;
		 var arrStyleSheet = doc.styleSheets;
		//var styleSheet = null;
		//var media = null; 
		//var styleSheetLength = arrStyleSheet.length;
		/* 1. search for media == "screen" */
		/*while(styleSheetLength > -1)
		{ 
			--styleSheetLength;
			// dont take into account the disabled stylesheets 
			if(arrStyleSheet[styleSheetLength].disabled) 
			{
				continue; 
			}
			media = arrStyleSheet[styleSheetLength].media;
			if(typeof media == "object")
			{
				media = media.mediaText;
			}
			if(media == "" || media=='all' || media.indexOf("screen") != -1)
			{
				styleSheet = arrStyleSheet[styleSheetLength];
				styleSheetLength = -1;   // indication that media=="screen" was found (if not, then styleSheetLength==0)
				break;
			}
		}*/
		var styleSheet = null;
		var styleSheetElement = document.getElementById(this.__sheetId);
		/* if not found, create one */
		//if(styleSheetLength != -1)
		if(styleSheetElement)
		{
			styleSheet = styleSheetElement.sheet;
		}
		else
		{
			var head = document.head || document.getElementsByTagName('head')[0];
			styleSheetElement = doc.createElement("style");
			styleSheetElement.setAttribute("id",this.__sheetId);
			styleSheetElement.setAttribute("type","text/css");
			head.appendChild(styleSheetElement);
			styleSheet = doc.styleSheets[arrStyleSheet.length - 1]; /* take the new stylesheet to add the className and the style */
		}
		var existingCSSClassList = null;
		var classLength = arrCSSText.length; 
		var className = null;
		var cssText = null;
		/* 3. add the className and style */
		switch (typeof styleSheet.media) 
		{
			case "string":
				existingCSSClassList = styleSheet.rules;
				for(var count = 0;count < classLength;count++)
				{
					className = arrClassName[count];
					cssText = arrCSSText[count];
					if(!checkExisting || !this.modifyExistingClass(existingCSSClassList, className, cssText))
					{
						styleSheet.addRule(className, cssText);
					}
				}
				break;
			case "object":
				existingCSSClassList = styleSheet.cssRules;
				for(var count = 0;count < classLength;count++)
				{
					className = arrClassName[count];
					cssText = arrCSSText[count];
					if(!checkExisting || !this.modifyExistingClass(existingCSSClassList, className, cssText))
					{
						styleSheet.insertRule(className + "{" + cssText + "}", styleSheet.cssRules.length);
					}
				}
				break;
		}
	 }
 };
 NSUtil.prototype.removeCSSClassInDOM = function(arrClassName,doc)
 {
	 if(!doc)
     {
		 doc = document; 
     }
	 if(doc.styleSheets && arrClassName)
	 {
		var styleSheet = null;
		var styleSheetElement = document.getElementById(this.__sheetId);
		if(styleSheetElement)
		{
			styleSheet = styleSheetElement.sheet;
		}
		var existingCSSClassList = null;
		var classLength = arrClassName.length; 
		var className = null;
		if(styleSheet && styleSheet.media)
		{
			/* 3. add the className and style */
			switch (typeof styleSheet.media) 
			{
				case "string":
					existingCSSClassList = styleSheet.rules;
					for(var count = 0;count < classLength;count++)
					{
						className = arrClassName[count];
						if(this.removeExistingClass(styleSheet,existingCSSClassList, className))
						{
							return true;
						}
					}
					break;
				case "object":
					existingCSSClassList = styleSheet.cssRules;
					for(var count = 0;count < classLength;count++)
					{
						className = arrClassName[count];
						if(this.removeExistingClass(styleSheet,existingCSSClassList, className))
						{
							return true;
						}
					}
					break;
			}
		 }
	 }
 };
 /*
  * If Class exists then modifies the content with new one and return true
  * If Class does not exist it returns false
  */
 NSUtil.prototype.modifyExistingClass = function(existingCSSClassList,className,cssText)
 {
	 if(existingCSSClassList && existingCSSClassList.length > 0)
	 {
		 var length = existingCSSClassList.length;
		 var cssClass = null;
		 for(var count = 0; count < length; count++) 
		 {
			cssClass = existingCSSClassList[count];
			if(cssClass.selectorText && cssClass.selectorText.toLowerCase() == className.toLowerCase()) 
			{
				cssClass.style.cssText = cssText;
				return true;
			}
		 }
	 }
	 return false;
};

NSUtil.prototype.removeExistingClass = function(styleSheet,existingCSSClassList,className)
{
	 if(styleSheet && existingCSSClassList && existingCSSClassList.length > 0)
	 {
		 var length = existingCSSClassList.length;
		 var cssClass = null;
		 for(var count = 0; count < length; count++) 
		 {
			cssClass = existingCSSClassList[count];
			if(cssClass.selectorText && cssClass.selectorText.toLowerCase() == className.toLowerCase()) 
			{
				var isRemoved = false;
				if("deleteRule" in styleSheet) 
				{ 
					styleSheet.deleteRule(count); 
					isRemoved = true;
				}
			    else if("removeRule" in styleSheet) 
			    { 
			    	styleSheet.removeRule(count); 
			    	isRemoved = true;
			    }
				if(isRemoved)
				{
					return true;
				}
			}
		 }
	 }
	 return false;
};
 
 NSUtil.prototype.addPseudoStyleFromExistingStyle = function(control,className,property,cssClassName,checkClassCallBack)
 {
 	var styleProperties = this.getCSSClass(cssClassName);
 	if(checkClassCallBack)
 	{
 		styleProperties = checkClassCallBack(styleProperties);
 	}
 	var _head = document.head || document.getElementsByTagName('head')[0];
 	var _sheet = document.getElementById(this.__sheetId) || document.createElement('style');
 	_sheet.id = this.__sheetId;
 	control.className +=  " " + className; 
 	_sheet.innerHTML += "\n." + className + ":" + property + "{" +styleProperties + "}";
 	_head.appendChild(_sheet);
 };

 NSUtil.prototype.getCSSClass = function(cssClassName)
 {
     if(!document.styleSheets) 
 	{
 		return "";
 	}
 	var regEx = null;
 	var styleSheets = document.styleSheets;
 	var counter = styleSheets.length;
 	var result = [];
     if(typeof cssClassName == "string") 
 	{
 		regEx = RegExp('\\b' + cssClassName + '\\b','i');
 	}
     while(counter)
 	{
     	var currentSheet = styleSheets[--counter];
     	var cssRules = (currentSheet.rules) ? currentSheet.rules: currentSheet.cssRules;
 		var cssRulesLength = cssRules.length;
     	for(var count = 0 ; count < cssRulesLength; count++)
 		{
     		var tempClassDetails = cssRules[count].selectorText ? [cssRules[count].selectorText, cssRules[count].style.cssText]: [cssRules[count]+''];
     		if(regEx.test(tempClassDetails[0])) 
 			{
 				result[result.length]= tempClassDetails;
 			}
     	}
     }
 	if(result && result.length === 1 && result[0] && result[0].length > 1)
 	{
 		return result[0][1];
 	}
     return result.join('\n\n');
 };
 
 NSUtil.prototype.convertCSSPropToJS = function(cssClassProp)
 {
	 if(cssClassProp)
	 {
		 var arrIndex = this.indexesOf(cssClassProp,"-");
		 if(arrIndex && arrIndex.length > 0)
		 {
			 for(var count = 0;count < arrIndex.length; count++)
			 {
				 var index = arrIndex[count] + 1;
				 cssClassProp = cssClassProp.substring(0,index) + cssClassProp[index].toUpperCase() + cssClassProp.slice(index + 1);
			 }
			 cssClassProp = cssClassProp.replaceAll("-","");
		 }
	 }
	 return cssClassProp;
 };
 
//CSS Property "transition","-o-transition","-ms-transition","-moz-transition","webkit-transition"
 //Javascript Equivalent "transition","OTransition","msTransition","MozTransition","WebkitTransition"
 NSUtil.prototype.getSupportedCSSPropertyName = function(arrPropertyNames)
 {
	 if(arrPropertyNames && arrPropertyNames.length > 0)
	 {
		 var root = document.documentElement;
		 for (var count=0; count < arrPropertyNames.length; count++)
	 	 {
		 	 //if property exists on element (value will be string, empty string if not set)
			 if(arrPropertyNames[count] in root.style)
	 		 { 
				 return arrPropertyNames[count];
	 		 }
	 	 }
	 }
	 return null;
 };
 
 NSUtil.prototype.throwNSError = function(componentName,message)
 {
 	throw new Error("Error in " + componentName + " with details::" + message);
 };
 
 NSUtil.prototype.warning = function(componentName,message)
 {
 	console.warn("Warning in " + componentName + " with details::" + message);
 };
 
 //gets the offset of the element 
 //equivalent offset() of jquery
 NSUtil.prototype.getOffSet = function(element, offset) 
 {
	 if(!offset)
	 {
		 offset = {left : 0, top : 0};
	 }
	 if(element)
     {
		offset.left += (element.offsetLeft - element.scrollLeft + element.clientLeft);
		offset.top += (element.offsetTop - element.scrollTop + element.clientTop);
	    offset = this.getOffSet(element.offsetParent, offset);
     }
	 return offset;
 };
 
//equivalent position() of jquery
 NSUtil.prototype.getPosition = function(element) 
 {
	 var offset = {left : 0, top : 0};
	 if(element)
     {
		 offset = {left : element.offsetLeft, top : element.offsetTop};
     }
	 return offset;
 };
 
 NSUtil.prototype.getOffSetForElementRectangle = function(rectElement) 
 {
	  var body = document.body || document.getElementsByTagName('body')[0];
	  var docElement = document.documentElement || body.parentNode;
	  var clientTop  = docElement.clientTop  || body.clientTop  || 0;
	  var clientLeft = docElement.clientLeft || body.clientLeft || 0;
	  var scrollTop  = window.pageYOffset || docElement.scrollTop;
	  var scrollLeft = window.pageXOffset || docElement.scrollLeft;
	  
	  var top = rectElement.top  + scrollTop  - clientTop;
	  var left = rectElement.left + scrollLeft - clientLeft;

	  return {top:top,left:left};
 };
 
 NSUtil.prototype.getDPI = function()
 {
 	var dpi = {width:0,height:0};
	var divDPI = this.createDiv(null,"nsGetDPI");
    document.body.appendChild(divDPI);
    dpi.width = divDPI.offsetWidth;
    dpi.height = divDPI.offsetHeight;
    document.body.removeChild(divDPI);
 	
 	return dpi;
 };
 
//gives dimension for the visible part i.e. body or viewport
 NSUtil.prototype.getBodyDimension = function() 
 {
	 var objReturn = {};
	 objReturn.width = window.innerWidth || document.documentElement.clientWidth || document.body.offsetWidth;
	 objReturn.height = window.innerHeight || document.documentElement.clientHeight || document.body.offsetHeight;
	 return objReturn;
 };
 
//gives dimension for the whole document i.e. with scroll bars
 NSUtil.prototype.getDocumentDimension = function() 
 {
	 var objReturn = {};
	 var doc = document;
	 objReturn.width = Math.max(
			 	doc.body.scrollWidth, doc.documentElement.scrollWidth,
			 	doc.body.offsetWidth, doc.documentElement.offsetWidth,
			 	doc.body.clientWidth, doc.documentElement.clientWidth
		    );
	 objReturn.height = Math.max(
			 	doc.body.scrollHeight, doc.documentElement.scrollHeight,
			 	doc.body.offsetHeight, doc.documentElement.offsetHeight,
			 	doc.body.clientHeight, doc.documentElement.clientHeight
		    );
	 return objReturn;
 };
 
 //equivalent to jquery outerHeight
 NSUtil.prototype.getOuterHeight = function(element)
 {
	 var height = -1;
	 if(element)
	 {
		 height = element.offsetHeight;
		 var style = window.getComputedStyle(element);
		 height += parseInt(style.marginTop) + parseInt(style.marginBottom);
	 }
	 return height;
 };
 //equivalent to jquery outerWidth
 NSUtil.prototype.getOuterWidth = function(element)
 {
	 var width = -1;
	 if(element)
	 {
		 width = element.offsetWidth;
		 var style = window.getComputedStyle(element);
		 width += parseInt(style.marginLeft) + parseInt(style.marginRight);
	 }
	 return width;
 };
 
 //returns measured width of text
 NSUtil.prototype.getWidthOfText = function(text,fontSize,fontName)
 {	
 	var canvas = document.createElement("canvas");
 	var context = canvas.getContext("2d");
 	var fontArgs = context.font.split(" ");
 	if(fontSize)
 	{
 		fontArgs[0] = fontSize;
 	}
 	if(fontName)
 	{
 		fontArgs[1] = fontName;
 	}
 	context.font = fontArgs[0] + " " + fontArgs[1];        
 	var width = context.measureText(text).width;
 	return width;
 };
 
 NSUtil.prototype.getMaxZIndex = function (element) 
 {
     var currentzIndex = -1;
     var maxZIndex = 0;
     var checkZIndex = function(currElement)
     {
     	currentzIndex = document.defaultView.getComputedStyle(currElement,null).getPropertyValue("z-index");
     	currentzIndex = parseInt(currentzIndex, 10);
     	maxZIndex = (currentzIndex) ? Math.max(maxZIndex, currentzIndex) : maxZIndex;
     };
     if(element)
     {
     	var currentElement = element;
         while(currentElement)
         {
         	checkZIndex(currentElement);
             currentElement = currentElement.offsetParent;
         }
     }
     else
     {
     	var arrElements = document.getElementsByTagName("*");
         var length = arrElements.length;
         for (var count = 0; count < length; count++) 
         {
         	checkZIndex(arrElements[count]);
         }
     }
     return maxZIndex;
 };

 
//function for scrollbar click detection
 //pass event.clientX for mouse events
 NSUtil.prototype.clickedOnScrollbar = function(element,mouseX)
 {
	 if(element)
	 {
		 return (this.getOuterWidth(element) <= mouseX);
	 }
	 return false;
 };
 
 //concept from https://tylercipriani.com/2014/07/12/crossbrowser-javascript-scrollbar-detection.html
 NSUtil.prototype.hasScrollbar = function(element,axis)
 {
	 if(!element)
	 {
		 element = document.documentElement || document.body;
	 }
     var overflowStyle = null;
     var overflowYStyle = null;
 
	 if (typeof element.currentStyle !== 'undefined') 
	 {
	     overflowStyle = element.currentStyle.overflow;
	     overflowYStyle = element.currentStyle.overflowY;
	 }
	 overflowStyle = overflowStyle || window.getComputedStyle(element, "").overflow;
	 overflowYStyle = overflowYStyle || window.getComputedStyle(element, "").overflowY;
	
	 if (axis === 'x') 
	 {
	     var contentOverflows = element.scrollWidth > element.clientWidth,
	         overflowShown = /^(visible|auto)$/.test(overflowStyle), 
	         alwaysShowScroll = overflowStyle === 'scroll';
	     return (contentOverflows && overflowShown) || (alwaysShowScroll);
	 }
	 else if (axis === 'y') 
	 {
	     var contentOverflows = element.scrollHeight > element.clientHeight,
	         overflowShown = /^(visible|auto)$/.test(overflowYStyle), 
	         alwaysShowScroll = overflowYStyle === 'scroll';
	     return (contentOverflows && overflowShown) || (alwaysShowScroll);
	 }
	 else 
	 {
	     var contentOverflows = element.scrollWidth > element.clientWidth || element.scrollHeight > element.clientHeight,
	         overflowShown    = /^(visible|auto)$/.test(overflowStyle) || /^(visible|auto)$/.test(overflowYStyle),
	         alwaysShowScroll = overflowStyle === 'scroll' || overflowYStyle === 'scroll';
	     
	     return (contentOverflows && overflowShown) || (alwaysShowScroll);
	 }
 };
 
 //gives position where event has occured(like mouseClick) 
 NSUtil.prototype.getEventPosition = function(event,parentWithScroll) 
 {
	  event = this.getEvent(event);
	  var left = 0;
	  var top = 0;
	  if (event.pageX || event.pageY) 
	  { 
		  left = event.pageX;
		  top = event.pageY;
	  }
	  else 
	  { 
		  left = event.clientX + document.body.scrollLeft + document.documentElement.scrollLeft; 
		  top = event.clientY + document.body.scrollTop + document.documentElement.scrollTop; 
	  }
	  if(parentWithScroll)
	  {
		  left += parentWithScroll.scrollLeft;
		  top += parentWithScroll.scrollTop;
	  }
	  return {left: left, top: top};
 };
 
 NSUtil.prototype.getMouseOffset = function(event,element)
 {
	 event = this.getEvent(event);
     var elementPosition = this.getCumulativeOffset(element);
     var mousePosition = this.getEventPosition(event);
     return {x:(mousePosition.left - elementPosition.x), y:(mousePosition.top - elementPosition.y)};
 };
 
 NSUtil.prototype.getMaxScrollPosition = function(element) 
 {
	 var offset = {left : 0, top : 0};
	 if(element)
     {
		 var maxX = element.scrollWidth - element.clientWidth;
         var maxY = element.scrollHeight - element.clientHeight;
		 offset = {left : maxX, top : maxY};
     }
	 return offset;
 };
 
 
 NSUtil.prototype.addTemplateInContainer = function(container,templateID) 
 {
	 if(container && templateID)
	 {
		 var templateClone = this.getTemplate(templateID);
		 if(templateClone)
		 {
			 container.appendChild(templateClone);
		 }
	 }
 };
 
 NSUtil.prototype.getTemplate = function(templateID) 
 {
	 var templateClone = null;
	 if(templateID)
	 {
		 if(typeof templateID === "string")
		 {
			 var template = document.getElementById(templateID);
			 if(template)
			 {
				 if(this.supportsTemplate())
				 {
					 templateClone = template.content.children[0]; //document.importNode(template.content, true); 
				 }
				 else
				 {
					 templateClone = template.cloneNode(true);
					 template.style.display = "none";
				 }
			 }
		 }
		 else
		 {
			 templateClone = templateID.cloneNode(true);
		 }
	 }
	 return templateClone;
 };
 
 NSUtil.prototype.supportsTemplate = function() 
 {
	 return ("content" in document.createElement('template'));
 };
 
 NSUtil.prototype.getTemplateFromURL = function(url,callback,errorCallback) 
 {
	 //this.supportsImports() && 
	 /*if(url && callback)
	 {
		 var link = document.createElement("link");
		 link.setAttribute("rel","import");
		 link.setAttribute("href",url);
		 var self = this;
		 var loadHandler = function(event)
		 {
			 var fragment = null;
			 if(link.import)
			 {
				 fragment = document.createDocumentFragment();
				 var doc = link.import.nodeName;//get document instance
				 var arrChildren = link.import.body.children;
				 var length = arrChildren.length; 
				 for(var count = 0;count < length;count++)
				 {
					 var child = arrChildren[count].cloneNode(true);
					 fragment.appendChild(child);
				 }
			 }
			 callback(fragment);
		 };
		 var errorHandler = function(event)
		 {
			 event = self.getEvent(event);
			 console.debug("Error loading Template from URL:: " + url);
			 if(errorCallback)
			 {
				 errorCallback(event);
			 }
		 };
		 this.addEvent(link,"load",loadHandler);
		 this.addEvent(link,"error",errorHandler);
		 document.head.appendChild(link);
	 }*/
	 if(url)
	 {
		var xmlhttp;
		if (window.XMLHttpRequest)
		{// code for IE7+, Firefox, Chrome, Opera, Safari
			xmlhttp = new XMLHttpRequest();
		}
		else
		{// code for IE6, IE5
			xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
		}
		xmlhttp.onreadystatechange=function()
		{
		  if(xmlhttp.readyState === 4)
		  {
			  if (xmlhttp.status === 200) 
			  {  
				  if(callback)
				  {
					  callback(xmlhttp.responseText);
				  }
		      } 
			  else 
			  {
				  console.debug("Error loading Template from URL:: " + url);
				  if(errorCallback)
				  {
					 errorCallback(xmlhttp.statusText);
				  }
		      }  
		  }
		}
		xmlhttp.open("GET",url,true);
		xmlhttp.send();
	 }
 };
 
 NSUtil.prototype.supportsImports = function() 
 {
	 return ("import" in document.createElement('link'));
 };
 
 NSUtil.prototype.removeAllChildren = function(element) 
 {
	if(element)
	{
		var node = element;
	    while (element.hasChildNodes()) 
	    {              

	        if (node.hasChildNodes()) 
	        {                
	            node = node.lastChild;                 
	        }
	        else 
	        {                                     
	            node = node.parentNode;                
	            node.removeChild(node.lastChild);      
	        }
	    }
	}
 };
 
 NSUtil.prototype.getScrollBarWidth = function(element)
 {
 	var scrollBarWidth = 0;
 	if(element)
 	{
 		scrollBarWidth = element.offsetWidth - element.clientWidth;
 	}
 	else
 	{
 		var divScroll = this.createDiv(null,"nsGetScrollBar");
 		var divScrollChild = this.createDiv(null);
 		divScroll.appendChild(divScrollChild);
        document.body.appendChild(divScroll);
        var oldWidth = divScrollChild.getBoundingClientRect().width;
        divScrollChild.style.height = "99px";
        var newWidth = divScrollChild.getBoundingClientRect().width;
        scrollBarWidth = oldWidth - newWidth;
        document.body.removeChild(divScroll);
 	}
 	return scrollBarWidth;
 };
 
 NSUtil.prototype.getKeyUnicode = function(event) 
 {
	 event = this.getEvent(event);
     var unicode=event.keyCode ? event.keyCode : event.charCode;
     return unicode;
 };
 
 NSUtil.prototype.getNumber = function(objNumber) 
 {
	 objNumber = Number(objNumber);
	 if(isNaN(objNumber))
	 {
		 objNumber = 0;
	 }
	 return objNumber;
 };

 NSUtil.prototype.getDimensionAsNumber = function(element,dimension)
 {
 	var retValue = 0;
 	var dimensionUnit = this.getDimensionUnit(dimension);
	if(dimensionUnit === 1 && element && element.parentNode)
	{
		dimension = dimension.substring(0,dimension.length - 1);
		retValue = (dimension / 100) * element.parentNode.offsetHeight;
	}
	else if(dimensionUnit === 2)
	{
		retValue = dimension.substring(0,dimension.length - 2);
	}
	else
	{
		retValue = dimension;
	}
 	if(retValue === "" || isNaN(retValue))
 	{
 		retValue = 0;
 	}
 	return parseInt(retValue);
 };
 
 /*returns 0 if dimension has no unit
  returns 1 if dimension is in %
  returns 2 if dimension is in px 
  returns -1 if dimension is not valid */ 
 NSUtil.prototype.getDimensionUnit = function(dimensionValue)
 {
 	var retValue = -1;
 	if(!this.isUndefined(dimensionValue) && dimensionValue != null )
 	{
 		retValue = 0;
 		if(dimensionValue.toString().substring(dimensionValue.toString().length - 1) == "%")
 		{
 			retValue = 1;
 		}
 		else if(dimensionValue.toString().substring(dimensionValue.toString().length - 2) == "px")
 		{
 			retValue = 2;
 		}
 	}
 	return retValue;
 };
 
 NSUtil.prototype.getCumulativeOffset = function(element)
 {
     var x = 0;
     var y = 0;
     var currentElement = (element.offsetHeight > 0) ? element : element.firstChild;
     while(currentElement)
     {
         x += currentElement.offsetLeft;
         y += currentElement.offsetTop;
         currentElement = currentElement.offsetParent;
     }
     return { x: x, y: y };
 };
 
 NSUtil.prototype.round = function(num, decimalPlaces) 
 {
     return Math.round(num * Math.pow(10, decimalPlaces)) / Math.pow(10, decimalPlaces);
 };
  
 NSUtil.prototype.makeElementUnselectable = function(element,makeChildrenUnselectable)
 {
	 if(element)
	 {
		 if (element.nodeType == 1) 
	     {
			 element.setAttribute("unselectable", "on");
	     }
		 if(makeChildrenUnselectable)
		 {
			 var childElement = element.firstChild;
		     while (childElement) 
		     {
		    	 this.makeElementUnselectable(childElement,makeChildrenUnselectable);
		         childElement = childElement.nextSibling;
		     }
		 }
	 }
 };
 
 NSUtil.prototype.makeBodyUnselectable = function()
 {
	 this.addStyleClass(document.body,"nsUnselectable");
 };
 
 NSUtil.prototype.makeBodySelectable = function()
 {
	 this.removeStyleClass(document.body,"nsUnselectable");
 };
 

NSUtil.prototype.startsWith = function(sourceString,searchString,caseSensitive) 
{
	if(!sourceString || !searchString)
	{
		return false;
	}
	if(caseSensitive)
	{
		return sourceString.length >= searchString.length && sourceString.substring(0, searchString.length) === searchString;
	}
	return sourceString.length >= searchString.length && sourceString.substring(0, searchString.length).toLowerCase() === searchString.toLowerCase();
};

NSUtil.prototype.endsWith = function(sourceString,searchString,caseSensitive) 
{
	if(!sourceString || !searchString)
	{
		return false;
	}
	if(caseSensitive)
	{
		return sourceString.length >= searchString.length && sourceString.substring(sourceString.length - searchString.length,sourceString.length) === searchString;
	}
	return sourceString.length >= searchString.length && sourceString.substring(sourceString.length - searchString.length,sourceString.length).toLowerCase() === searchString.toLowerCase();
};

NSUtil.prototype.contains = function(sourceString,searchString,startIndex,caseSensitive) 
{
	if(!sourceString || !searchString)
	{
		return false;
	}
	if(isNaN(startIndex))
	{
		startIndex = 0;
	}
	if(caseSensitive)
	{
		return sourceString.length >= searchString.length && ''.indexOf.call(sourceString, searchString, startIndex) !== -1;
	}
	return sourceString.length >= searchString.length && ''.indexOf.call(sourceString.toLowerCase(), searchString.toLowerCase(), startIndex) !== -1;
};

NSUtil.prototype.indexesOf = function(sourceString,charToFind) 
{
	var match = "";
    var arrIndexes = [] ;
	if(sourceString && charToFind)
	{
		var regex = new RegExp(charToFind,"g");
		while (match = regex.exec(sourceString)) 
		{
			arrIndexes.push(match.index);
	    }
	}
	return arrIndexes;
};

NSUtil.prototype.checkRegexValue = function(strRegex,value) 
{
	try
	{
		var regex = new RegExp(strRegex,"g");
	    return regex.test(value);
	}
    catch(error)
    {
    	console.log("Invalid Regex with details::" + error.message);
    }
    return false;
};

NSUtil.prototype.isValueNull = function(value) 
{
	if(value === null || this.isUndefined(value))
	{
		return true;
	}
	var nullValues = ["null"];
	var len = nullValues.length;
	for (var count = 0;count < len; count++)
	{
	    if (value === nullValues[count]) 
	    {
	    	return true;
	    }
	}
	return false;
};

NSUtil.prototype.highlightText = function(container,searchText,styleClass) 
{
	function innerHighlight(node,text,styleClass) 
	{
		  var skip = 0;
		  if (node.nodeType == 3) 
		  {
			   var position = node.data.toUpperCase().indexOf(text);
			   position -= (node.data.substr(0, position).toUpperCase().length - node.data.substr(0, position).length);
			   if (position >= 0) 
			   {
					var spannode = document.createElement("span");
					spannode.className = styleClass;
					var middlebit = node.splitText(position);
					var endbit = middlebit.splitText(text.length);
					var middleclone = middlebit.cloneNode(true);
					spannode.appendChild(middleclone);
					middlebit.parentNode.replaceChild(spannode, middlebit);
					skip = 1;
			   }
		  }
		  else if (node.nodeType == 1 && node.childNodes && !/(script|style)/i.test(node.tagName)) 
		  {
			   for (var count = 0; count < node.childNodes.length; ++count) 
			   {
					count += innerHighlight(node.childNodes[count], text,styleClass);
			   }
		  }
		  return skip;
	}
	if(container && searchText)
	{
		if(!styleClass)
		{
			styleClass = "nsTextHighlight";
		}
		var util = new NSUtil();
		if(util.isArray(searchText))
		{
			 for (var count = 0; count < searchText.length; count++) 
			 {
				 innerHighlight(container,searchText[count].toUpperCase(),styleClass);
			 }
		}
		else
		{
			innerHighlight(container,searchText.toUpperCase(),styleClass);
		}
		
	}
};

NSUtil.prototype.unHighlightText = function(container,styleClass) 
{
	if(container)
	{
		if(!styleClass)
		{
			styleClass = "nsTextHighlight";
		}
		var arrHighlight = container.querySelectorAll("span." + styleClass); 
		if(arrHighlight && arrHighlight.length > 0)
		{
			var elementHighlight = null;
			var length = arrHighlight.length;
			for(var count = 0;count < length;count++)
			{
				elementHighlight = arrHighlight[count];
				if(elementHighlight)
				{
					elementHighlight.parentNode.replaceChild(elementHighlight.firstChild, elementHighlight);
				}
			}
		}
	}
};

 var falseExpression = /^(?:f(?:alse)?|no?|0+)$/i;
 Boolean.parse = function(value) 
 { 
    return !falseExpression.test(value) && !!value;
 };

//Defining the indexOf function (before you call it!) if it doesn't exist taken from MDN (for Internet Explorer 8 and below)
if (!Array.prototype.indexOf)
{
   Array.prototype.indexOf = function (searchElement /*, fromIndex */ )
   {
     'use strict';
     if (this == null)
     {
       throw new TypeError();
     }
     var n, k, t = Object(this),
         len = t.length >>> 0;
     if (len === 0)
     {
       return -1;
     }
     n = 0;
     if (arguments.length > 1) 
     {
       n = Number(arguments[1]);
       if (n != n)
       { // shortcut for verifying if it's NaN
         n = 0;
       }
       else if (n != 0 && n != Infinity && n != -Infinity)
       {
         n = (n > 0 || -1) * Math.floor(Math.abs(n));
       }
     }
     if (n >= len)
     {
       return -1;
     }
     for (k = n >= 0 ? n : Math.max(len - Math.abs(n), 0); k < len; k++)
     {
       if (k in t && t[k] === searchElement)
       {
         return k;
       }
     }
     return -1;
   };
}

//JavaScript Array filter
if (!Array.prototype.filter) 
{
    Array.prototype.filter = function(fun /*, thisp*/) 
    {
        var len = this.length >>> 0;
        if (typeof fun != "function") 
        {
            throw new TypeError();
        }
        var res = [];
        var thisp = arguments[1];
        for (var count = 0; count < len; count++) 
        {
            if (count in this) 
            {
                var val = this[count]; // in case fun mutates this
                if (fun.call(thisp, val, count, this)) 
                {
                    res.push(val);
                }
            }
        }

        return res;
    };
}

if (!String.prototype.replaceAll) 
{
	String.prototype.replaceAll = function(character,replaceChar)
	{
	    var word = this.valueOf();
	    while(word.indexOf(character) != -1)
	    {
	    	word = word.replace(character,replaceChar);
	    }
	    return word;
	};
}

if (!HTMLTableRowElement.prototype.update) 
{
	HTMLTableRowElement.prototype.update = function()
	{
		var util = new NSUtil();
		var grid = util.findParent(this,"ns-grid");
		if(grid)
		{
			grid.updateRow(parseInt(this.getAttribute("index")));
		}
	};
}

//From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys
if (!Object.keys) 
{
  Object.keys = (function() {
    'use strict';
    var hasOwnProperty = Object.prototype.hasOwnProperty,
        hasDontEnumBug = !({ toString: null }).propertyIsEnumerable('toString'),
        dontEnums = [
          'toString',
          'toLocaleString',
          'valueOf',
          'hasOwnProperty',
          'isPrototypeOf',
          'propertyIsEnumerable',
          'constructor'
        ],
        dontEnumsLength = dontEnums.length;

    return function(obj) {
      if (typeof obj !== 'object' && (typeof obj !== 'function' || obj === null)) {
        throw new TypeError('Object.keys called on non-object');
      }

      var result = [];

      for (var prop in obj) {
        if (hasOwnProperty.call(obj, prop)) {
          result.push(prop);
        }
      }

      if (hasDontEnumBug) {
        for (var i = 0; i < dontEnumsLength; i++) {
          if (hasOwnProperty.call(obj, dontEnums[i])) {
            result.push(dontEnums[i]);
          }
        }
      }
      return result;
    };
  }());
}

//https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find
if (!Array.prototype.find) 
{
	  Array.prototype.find = function(predicate) 
	  {
	    if (this === null) {
	      throw new TypeError('Array.prototype.find called on null or undefined');
	    }
	    if (typeof predicate !== 'function') {
	      throw new TypeError('predicate must be a function');
	    }
	    var list = Object(this);
	    var length = list.length >>> 0;
	    var thisArg = arguments[1];
	    var value;
	
	    for (var i = 0; i < length; i++) {
	      value = list[i];
	      if (predicate.call(thisArg, value, i, list)) {
	        return value;
	      }
	    }
	    return undefined;
	  };
}

//https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex
if (!Array.prototype.findIndex) 
{
	  Array.prototype.findIndex = function(predicate) {
	    if (this === null) {
	      throw new TypeError('Array.prototype.findIndex called on null or undefined');
	    }
	    if (typeof predicate !== 'function') {
	      throw new TypeError('predicate must be a function');
	    }
	    var list = Object(this);
	    var length = list.length >>> 0;
	    var thisArg = arguments[1];
	    var value;

	    for (var i = 0; i < length; i++) {
	      value = list[i];
	      if (predicate.call(thisArg, value, i, list)) {
	        return i;
	      }
	    }
	    return -1;
	  };
}

if (!String.prototype.format) 
{
	String.prototype.format = function()
	{
	   var content = this;
	   for (var i=0; i < arguments.length; i++)
	   {
	        var replacement = '{' + (i + 1) + '}';
	        content = content.replace(replacement, arguments[i]);  
	   }
	   return content;
	};
};


NSUtil.prototype.defaultRenderer = function()
{
	this.util = new NSUtil();
	this.divItemRenderer = null;
	
	this.getRenderer = function()
	{
		if(!this.divItemRenderer)
		{
			this.__createComponents();
		}
		return this.divItemRenderer;
	};
	
	this.setData = function(renderer,item,labelField)
	{
		if(renderer)
		{
			if(item && item[labelField])
			{
				renderer.rendererBody.rendererLabel.innerHTML = item[labelField];
				//renderer.rendererBody.rendererLabel.appendChild(document.createTextNode(item[labelField]));
			}
			else
			{
				this.clearData(renderer);
			}
		}
		
	};
	
	this.clearData = function(renderer)
	{
		if(renderer)
		{
			renderer.rendererBody.rendererLabel.innerHTML = "";
		}
	};
	
	this.__createComponents = function()
	{
		this.divItemRenderer = this.util.createDiv(null,"nsListRenderer"); 
		//this.divItemRenderer.style.height = 20 + "px";
		this.divItemRenderer.style.padding = 1 + "px";
		this.divItemRenderer.setAttribute("accessor-name","rendererBody"); 
		var lblItemRenderer = document.createElement("LABEL");
		lblItemRenderer.setAttribute("accessor-name","rendererLabel");
		this.divItemRenderer.appendChild(lblItemRenderer);
	};
};

NSUtil.prototype.fadeIn = function(element,displayType,callback)
{
	if(element)
	{
		var util = this;
		element.style.opacity = 0;
		element.style.display = displayType || "block";
		(function fade() 
		 {
		    var value = parseFloat(element.style.opacity);
		    if (!((value += .1) > 1)) 
		    {
		    	element.style.opacity = value;
		    	util.getRequestAnimationFrame.bind(window)(fade.bind(util));
		    }
		    else
		    {
		    	if(callback)
		      	{
		    		callback(element);
		      	}
		    }
		 })();
	}
};

NSUtil.prototype.fadeOut = function(element,callback)
{
	var util = this;
	element.style.opacity = 1;
	(function fade() 
	{
	    if((element.style.opacity -= .1) < 0) 
	    {
	      element.style.display = "none";
	      if(callback)
	      {
	    	  callback(element);
	      }
	    } 
	    else 
	    {
	    	util.getRequestAnimationFrame.bind(window)(fade.bind(util));
	    }
	})();
};

NSUtil.prototype.addAnimatedLineOnHover = function(element,config)
{
	if(element)
	{
		if(!config)
		{
			config = {};
		}
		var setting = {
				lineWidth : (config.lineWidth) ? config.lineWidth : element.offsetWidth,
				lineHeight : (config.lineHeight) ? config.lineHeight : 5,
				lineColor : (config.lineColor) ? config.lineColor : "black",
				offsetX : (config.offsetX) ? config.offsetX : 0,
				offsetY : (config.offsetY) ? config.offsetY : 0,
		};
		var offset = this.getCumulativeOffset(element);
		var id = element.getAttribute("id");
		if(!id)
		{
			id = this.getUniqueId();
		}
		var styleName = "ns" + id + "line";
		this.addCSSClassInDOM(["." + styleName + ":after"],["content: '';position: absolute;height: " + setting.lineHeight + "px;width: 0%;left: " + (offset.x + setting.offsetX) + "px;" +
														 "top: " + (offset.y + element.offsetHeight + setting.offsetY) + "px;" +
														 "background-color: " + setting.lineColor + ";-webkit-transition: width 200ms ease-in;transition: width 200ms ease-in;"]);
		this.addCSSClassInDOM(["." + styleName + ":hover:after"],["width:" + setting.lineWidth + "px;"]);
		this.addStyleClass(element,styleName);
	}
};

NSUtil.prototype.getTextBetweenSymbol = function(strText,startSymbol,endSymbol)
{
	var arrReturn = null;
	if(strText)
	{
		if(!startSymbol)
		{
			startSymbol = "{{";
		}
		if(!endSymbol)
		{
			endSymbol = "}}";
		}
		var regexString = "\\" + startSymbol + "([^" + endSymbol + "]+)\\" + endSymbol;
		var regex = new RegExp(regexString,"g");
		var arrMatches = strText.match(regex);
		if(arrMatches && arrMatches.length > 0)
		{
			arrReturn = [];
			var length = arrMatches.length;
			var subStrLength = startSymbol.length;
			for (var count = 0; count < length; count++) 
			{
			    var match = arrMatches[count];
			    arrReturn.push(match.substring(subStrLength,match.length - subStrLength));
			}
		}
	}
	return arrReturn;
};

NSUtil.prototype.groupCollection = function(dataSource,setting)
{
	this.__dataSource = dataSource;
	this.__util = new NSUtil();
	this.__childField = null;
	this.__parentLevelIndicatorField = null;
	this.__isSingleLevel = true;
	this.__groupField = null;
	this.__childrenCountField = null;
	if(setting)
	{
		this.__childField = setting["childField"];
		this.__parentLevelIndicatorField = setting["parentLevelIndicatorField"];
		this.__isSingleLevel = setting["isSingleLevel"];
		this.__groupField = setting["groupField"];
		this.__childrenCountField = setting["childrenCountField"];
	}
	if(!this.__childField)
	{
		this.__childField = "children";
	}
	if(!this.__parentLevelIndicatorField)
	{
		this.__parentLevelIndicatorField = "ns-IsParent";
	}
	if(this.__util.isUndefined(this.__isSingleLevel))
	{
		this.__isSingleLevel = true;
	}
	if(!this.__groupField)
	{
		this.__groupField = "nsGroup";
	}
	if(!this.__childrenCountField)
	{
		this.__childrenCountField = "nsChildrenCountField";
	}
	this.groupBy = function(arrGroupField)
	{
		var arrResult = this.__dataSource;
  	    if(arrGroupField && arrGroupField.length > 0)
  	    {
  	    	if(this.__isSingleLevel)
  	    	{
  	    		arrResult = this.__groupByFieldOnSingleLevel(this.__dataSource,arrGroupField);
  	    	}
  	    	else
  	    	{
  	    		arrResult = this.__groupByFieldOnMultiLevel(this.__dataSource,arrGroupField);
  	    	}
  	    	
  	    }
  	    return arrResult;
	};
	
	this.__groupByFieldOnSingleLevel = function(list,arrGroupField)
	{
		var groups = {};
		if(list)
		{
			for (var count = 0; count < list.length; count++) 
	  	    {
	  	    	var item = list[count];
	  	    	var arrItems = this.__getGroupItemValues(item,arrGroupField);
	  	        var group = JSON.stringify(arrItems);
	  	        if (group in groups) 
	  	        {
	  	            groups[group][this.__childField].push(item); 
	  	        } 
	  	        else 
	  	        {
	  	        	var objEmpty = this.__createEmptyItem(list[count]);
	  	        	objEmpty[this.__parentLevelIndicatorField] = true;
	  	        	for(var fieldCount = 0;fieldCount < arrGroupField.length;fieldCount++)
	  	    		{
	  	        		var fieldName = arrGroupField[fieldCount];
	  	        		objEmpty[fieldName] = item[fieldName];
	  	    		}
	  	        	objEmpty[this.__childField] = [];
	  	        	objEmpty[this.__childField].push(item); 
	  	            groups[group] = objEmpty;
	  	        }
	  	    }
		}
  	    return this.__arrayFromObject(groups);
	};
	
	this.__getGroupItemValues = function(item,arrGroupField)
	{
		var arrResult = [];
		if(item && arrGroupField && arrGroupField.length > 0)
    	{
    		for(var count = 0;count < arrGroupField.length;count++)
    		{
    			var fieldValue = item[arrGroupField[count]];
    			if(!this.__util.isUndefined(fieldValue) && fieldValue != null)
    			{
    				arrResult.push(fieldValue);
    			}
    		}
    	}
		return arrResult;
	};
	
	this.__groupByFieldOnMultiLevel = function(list,arrGroupField)
	{
		var arrSource = list;
		for(var fieldCount = 0;fieldCount < arrGroupField.length;fieldCount++)
  		{
      		var fieldName = arrGroupField[fieldCount];
      		arrSource = this.__groupByField(arrSource,fieldName);
  		}
		return arrSource;
	};
	
	this.__groupByField = function(source,field)
	{
		var arrReturn = [];
		if(source && field)
		{
			var groups = {};
			for (var count = 0; count < source.length; count++) 
	  	    {
				var item = source[count];
				if(item.hasOwnProperty(this.__childField) && item[this.__childField].length > 0)
				{
					var arrChildren = this.__groupByField(item[this.__childField],field);
					if(arrChildren && arrChildren.length > 0)
					{
						item[this.__childField] = arrChildren;
					}
					arrReturn.push(item);
				}
				else
				{
					var group = item[field];
					if (group in groups) 
		  	        {
		  	            groups[group][this.__childField].push(item); 
		  	            groups[group][this.__childrenCountField] += 1;
		  	        } 
		  	        else 
		  	        {
		  	        	var objEmpty = this.__createEmptyItem(item);
		  	        	objEmpty[this.__parentLevelIndicatorField] = true;
		  	        	objEmpty[field] = item[field];
		  	        	objEmpty[this.__groupField] = item[field];
		  	        	objEmpty[this.__childField] = [];
		  	        	objEmpty[this.__childField].push(item);
		  	        	objEmpty[this.__childrenCountField] = 1;
		  	            groups[group] = objEmpty;
		  	        }
				}
	  	    }
			if(groups)
			{
				var arrChild = this.__arrayFromObject(groups);
				if(arrChild && arrChild.length > 0)
				{
					for (var childCount = 0; childCount < arrChild.length; childCount++) 
			  	    {
						arrReturn.push(arrChild[childCount]);
			  	    }
				}
			}
		}
		return arrReturn;
	};
	
	this.__arrayFromObject = function(objArr)
	{
		var arr = [];
		if(objArr)
		{
			for (var count in objArr) 
	  	    {
	  	        arr.push(objArr[count]);
	  	    }
		}
  	    return arr;
	};
	
	this.__createEmptyItem = function(objSource)
  	{
  		var objCopy = {};
  		if (objSource instanceof Object) 
  		{
  	        for (var attr in objSource) 
  	        {
  	            if (objSource.hasOwnProperty(attr))
  	            {
  	            	objCopy[attr] = null;
  	            }
  	        }
  	    }
  		return objCopy;
  	};
};

/** Expalination http://javascript.info/tutorial/animation of animation .. not the code **/
NSUtil.prototype.animation = function(element,arrOptions)
{
	this.__element = element;
	this.__arrOptions = arrOptions;
	this.__util = new NSUtil();
	
	this.__duration = 0;
	this.__currentOption = null;
	this.__currentStart = 0;
	this.__currentEnd = 0;
	
	this.animate = function()
	{
		this.__run();
	};
	
	this.__run = function() 
	{
	    var current = +new Date();
	    var remaining = this.__currentEnd - current;
	    if(remaining < this.__util.ANIMATIONDELAY) 
	    {
		      if(this.__currentOption) 
		      {
		    	  this.__step(1);  //1 = progress is at 100%
		    	  if(this.__currentOption.animationCompleteHandler)
		    	  {
		    		  this.__currentOption.animationCompleteHandler(this.__currentOption);
		    	  }
		      }
		      this.__currentOption = this.__arrOptions.shift();  //get the next item
		      if(this.__currentOption) 
		      {
		    	  if(this.__currentOption["style"])
		    	  {
		    		  this.__currentStart = this.__util.getDimensionAsNumber(this.__element,this.__element.style[this.__currentOption.style]);
		    	  }
		    	  else
		    	  {
		    		  this.__currentStart = this.__element[this.__currentOption.property];
		    	  }
		    	  this.__duration = this.__currentOption.time * 1000;
		    	  this.__currentEnd = current + this.__duration;
		    	  this.__step(0);  //0 = progress is at 0%
		      }
		      else 
		      {
		        return;
		      }
	    }
	    else 
	    {
		      var progress = remaining / this.__duration;
		      var delta = this.__delta(progress);
		      this.__step(delta);
	    }
	    this.__util.getRequestAnimationFrame.bind(window)(this.__run.bind(this));
	};
	
	this.__delta = function(progress)
	{
		return (1 - Math.pow(progress, 3));  //easing formula
	};
	
	this.__step = function(progress) 
	{
		var newValue = progress * (this.__currentOption.target - this.__currentStart) + this.__currentStart;
		if(this.__currentOption["style"])
  	  	{
			this.__element.style[this.__currentOption.style] = newValue + "px";
			//this.__element.style[this.__currentOption.style] = (progress * this.__currentOption.target) + "px";
  	  	}
		else
		{
			this.__element[this.__currentOption.property] = newValue;
		}
	};
};

NSUtil.prototype.getSearchTextBox = function(textInput)
{
	var divWrapper = null;
	if(textInput)
	{
		var id = textInput.getAttribute("id");
		var parent = textInput.parentNode;
		divWrapper = this.createDiv(id + "searchWrapper","nsSearchTextBoxWrapper");
		this.addStyleClass(textInput,"nsSearchInput");
		var divSearchWrapper = this.createDiv(id + "searchIconWrapper","nsSearchIconWrapper");
		var divSearchParent = this.createDiv(id + "searchIconParent","nsSearchIconParent");
		var objSVG = new NSSvg();
		var searchID = new NSSvgShapes().__SEARCH_ICON_ID;
		var svg = objSVG.addSVG(divSearchParent,id + "searchsvg","nsSearchIcon",null,null,null,null,null,null,false);
		objSVG.addUse(svg,id + "use",null,"#" + searchID);
		divSearchWrapper.appendChild(divSearchParent);
		divWrapper.appendChild(divSearchWrapper);
		if(parent)
		{
			parent.replaceChild(divWrapper,textInput);
		}
		divWrapper.appendChild(textInput);
	}
	return divWrapper;
};

NSUtil.prototype.transition = function(element,transitionEndCallback)
{
	this.__element = element;
	this.__transitionEndCallback = transitionEndCallback;
	this.__transitions = {
      'transition':'transitionend',
      'OTransition':'oTransitionEnd',
      'MozTransition':'transitionend',
      'WebkitTransition':'webkitTransitionEnd'
    };
	this.__util = new NSUtil();
	this.getTransitionEvent = function()
	{
		if(this.__element)
		{
			for(var trans in this.__transitions)
			{
		        if(this.__element.style[trans] !== undefined)
		        {
		            return this.__transitions[trans];
		        }
		    }
		}
		return null;
	};
	this.callEndCallBack = function()
	{
		var transitionEvent = this.getTransitionEvent();
		if(transitionEvent && this.__transitionEndCallback)
		{
			this.__util.addEvent(this.__element,transitionEvent,this.__transitionEndCallback);
		}
	};
	this.callEndCallBack();
};

NSUtil.prototype.getRequestAnimationFrame = (function()
{
	  return  window.requestAnimationFrame       ||
	          window.webkitRequestAnimationFrame ||
	          window.mozRequestAnimationFrame    ||
	          window.oRequestAnimationFrame      ||
	          function(callback)
	          {
	              window.setTimeout(callback,1000 / 60);
	          };
})();

NSUtil.prototype.getCancelAnimationFrame = (function() 
{
    return window.cancelAnimationFrame           	||
	       window.webkitCancelRequestAnimationFrame ||
	       window.mozCancelRequestAnimationFrame    ||
	       window.oCancelRequestAnimationFrame      ||
	       window.msCancelRequestAnimationFrame     ||
	       clearTimeout;
})();

NSUtil.prototype.fitStringToElement = function(element)
{
	if(element)
	{
		var str = element.innerHTML;
		var width = element.getBoundingClientRect().width;
		function escTag(string)
		{ 
			return string.replace("<","&lt;").replace(">","&gt;");
		}
		//Create a span element that will be used to get the width
		var span = document.createElement("span");
		//Allow a classname to be set to get the right font-size.
		if (element.className) 
		{
			span.className = element.className;
		}
		span.style.display = 'inline';
		span.style.visibility = 'hidden';
		span.style.padding = '0px';
		document.body.appendChild(span);

		var result = escTag(str); // default to the whole string
		span.innerHTML = result;
		// Check if the string will fit in the allowed width. NOTE: if the width
		// can't be determined (offsetWidth==0) the whole string will be returned.
		if (span.offsetWidth > width) 
		{
			var posStart = 0, posMid, posEnd = str.length, posLength;
			// Calculate (posEnd - posStart) integer division by 2 and
			// assign it to posLength. Repeat until posLength is zero.
			while (posLength = (posEnd - posStart) >> 1) 
			{
			  posMid = posStart + posLength;
			  //Get the string from the beginning up to posMid;
			  span.innerHTML = escTag(str.substring(0,posMid)) + '&hellip;';

			  // Check if the current width is too wide (set new end)
			  // or too narrow (set new start)
			  if(span.offsetWidth > width) 
			  {
				posEnd = posMid; 
			  }
			  else 
			  {
				posStart=posMid;
			  }
			}

			result = '<abbr title="' + str.replace("\"","&quot;") + '">' + escTag(str.substring(0,posStart)) +'&hellip;<\/abbr>';
		}
		document.body.removeChild(span);
		return result;
	}
	return null;
};

NSUtil.prototype.loader = function(parentContainer,isOverlayRequired)
{
	this.parentContainer = parentContainer;
	this.isOverlayRequired = isOverlayRequired;
	this.util = new NSUtil();
	this.divOverlay = null;
	this.divLoaderContainerParent = null;
	this.canvasLoader = null;
	this.loaderContext= null;
	this.idPrefix = null;
	this.loaderLines = 16;
	this.canvasWidth = 100;
	this.canvasHeight = 100;
	this.animationStart = null;
	this.orignalParentPosition = null;
	this.documentResizeRef = null;
	this.timeout = null;
	this.isVisible = false;
	
	this.createComponents = function()
	{
		if(!this.documentResizeRef)
		{
			this.documentResizeRef = this.documentResizeListener.bind(this);
			this.util.addEvent(window,"resize",this.documentResizeRef);
		}
		this.idPrefix = this.parentContainer.id ? this.parentContainer.id : this.util.getUniqueId();
		if(this.util.isUndefined(this.isOverlayRequired))
		{
			this.isOverlayRequired = true;
		}
		if(this.isOverlayRequired)
		{
			this.orignalParentPosition = this.parentContainer.style.position;
			this.parentContainer.style.position = "relative";
			this.divOverlay = this.util.createDiv("divOverlay","nsLoaderOverlay");
			this.divOverlay.style.height = this.parentContainer.offsetHeight + "px";
			this.divOverlay.style.width = this.parentContainer.offsetWidth + "px";
			this.parentContainer.appendChild(this.divOverlay);
		}
		this.divLoaderContainerParent = this.util.createDiv(this.idPrefix + "divLoaderContainerParent","nsLoaderContainerParent"); 
		this.parentContainer.appendChild(this.divLoaderContainerParent);
		var divLoaderContainer = this.util.createDiv(this.idPrefix + "divLoaderContainer","nsLoaderContainer"); 
		this.divLoaderContainerParent.appendChild(divLoaderContainer);
		this.canvasLoader = document.createElement("canvas");
		this.canvasLoader.id = this.idPrefix + "canvas";
		this.canvasLoader.width = this.canvasWidth;
		this.canvasLoader.height = this.canvasHeight;
		this.canvasLoader.style.background = "#FFFFFF";
		this.canvasLoader.style.position = "absolute";
		divLoaderContainer.appendChild(this.canvasLoader);
		this.loaderContext= this.canvasLoader.getContext("2d");
		
		var divLoadingLabel = this.util.createDiv(this.idPrefix + "divLoadingLabel","nsLoaderText"); 
		divLoadingLabel.appendChild(document.createTextNode("Loading"));
		divLoaderContainer.appendChild(divLoadingLabel);
		
		this.centerElement(this.divLoaderContainerParent);
		var canvasLeft = (((divLoaderContainer.offsetWidth - this.canvasWidth) / 2) - 5);
		var canvasTop = Math.max((((divLoaderContainer.offsetHeight - this.canvasHeight) / 2)),0);
		this.canvasLoader.style.left = canvasLeft + "px";
		this.canvasLoader.style.top = canvasTop + "px";
		this.centerElement(divLoadingLabel);
		divLoadingLabel.style.top = (canvasTop + this.canvasHeight) + "px";
		this.animationStart = new Date();
		window.setInterval(this.draw.bind(this), 1000 / 30);
	};
	
	this.centerElement = function(component)
	{
		if(component)
		{
			var parent = component.parentNode;
			component.style.left = ((parent.offsetWidth - component.offsetWidth) / 2) + "px";
			component.style.top = ((parent.offsetHeight - component.offsetHeight) / 2) + "px";
		}
	};
	
	this.draw = function() 
	{
	    var rotation = parseInt(((new Date() - this.animationStart) / 1000) * this.loaderLines) / this.loaderLines;
	    this.loaderContext.save();
	    this.loaderContext.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
	    this.loaderContext.translate(this.canvasWidth / 2, this.canvasHeight / 2);
	    this.loaderContext.rotate(Math.PI * 2 * rotation);
	    for (var count = 0; count < this.loaderLines; count++) {
	 
	    	this.loaderContext.beginPath();
	    	this.loaderContext.rotate(Math.PI * 2 / this.loaderLines);
	    	this.loaderContext.moveTo(this.canvasWidth / 10, 0);
	    	this.loaderContext.lineTo(this.canvasWidth / 4, 0);
	    	this.loaderContext.lineWidth = this.canvasWidth / 30;
	    	this.loaderContext.strokeStyle = "rgba(0,0,0," + count / this.loaderLines + ")";
	    	this.loaderContext.stroke();
	    }
	    this.loaderContext.restore();
	};
	
	this.documentResizeListener = function(event)
	{
		clearTimeout(this.timeout);
		var self = this;
		this.timeout = setTimeout(function () {
				self.resizeHandler.bind(self)();
		    }, 500);
		
	};
	
	this.resizeHandler = function()
	{
		if(this.isVisible)
		{
			this.hide();
			this.show();
		}
	};
	
	this.show = function()
	{
		if(!this.divLoaderContainerParent)
		{
			this.createComponents();
		}
		this.divLoaderContainerParent.style.display = "inline-block";
		if(this.isOverlayRequired)
		{
			this.divOverlay.style.display = "inline-block";
			this.parentContainer.style.position = "relative";
		}
		this.isVisible = true;
	};
	
	this.hide = function()
	{
		if(this.divLoaderContainerParent)
		{
			this.divLoaderContainerParent.parentNode.removeChild(this.divLoaderContainerParent);
			this.divLoaderContainerParent = null;
			//this.divLoaderContainerParent.style.display = "none";
		}
		if(this.divOverlay)
		{
			//this.divOverlay.style.display = "none";
			this.divOverlay.parentNode.removeChild(this.divOverlay);
			this.divOverlay = null;
			this.parentContainer.style.position = this.orignalParentPosition;
		}
		if(this.documentResizeRef)
		{
			this.util.removeEvent(window,"resize",this.documentResizeRef);
			this.documentResizeRef = null;
		}
		this.isVisible = false;
	};
};

NSUtil.prototype.ajax = function(setting)
{
	this.__setting = setting;
	this.__config = null;
	this.__request = null;
	this.__requestDone = false;
	this.__functionNameInitials = "nsjsonp";
	this.__instanceNameInitials = "nsjsonpIns";
	this.__random = -1;
	this.util = new NSUtil();
	
	this.__bindFunction = function (caller, object) 
	{
		return function() 
		{
			return caller.apply(object, [object]);
		};
	};
	
	this.__handleJSONP = function()
	{
		if(this.__random === -1)
		{
			this.__random = this.util.getUniqueId();
		}
		var functionName = this.__functionNameInitials + this.__random;
		var instanceName = this.__instanceNameInitials + this.__random;
		window[instanceName] = this;
		window[functionName] = function(json){
			if(window[instanceName])
			{
				window[instanceName].__defaultSuccessHandler(json,"jsonp");
			}
		};
		var url = this.__config.url + "?callback=" + functionName;
		var strParam = this.__getParam();
		if(strParam && strParam != "")
		{
			url += "&" + strParam;
		}
		this.__createScript(url);	
	};
	
	this.__createScript = function(url)
	{
        var domPosition = document.getElementsByTagName("body")[0];
        var script = document.createElement("script");
        script.async = true;
        script.setAttribute("id", url);
        script.setAttribute("type","text/javascript");
        script.setAttribute("src",url);
        script.onload = script.onreadystatechange = function()
        {
        	if (!script.readyState || /loaded|complete/.test(script.readyState)) 
        	{
				script.onload = script.onreadystatechange = null;
				if (script.parentNode) 
				{
					script.parentNode.removeChild(script);
				}
				script = null;
			}
        }; 
        domPosition.appendChild(script);
	};

	this.__stateChange = function (object) 
	{
		if (this.__request.readyState === 4 && !this.__requestDone)
		{
			var data = this.__getResponseData();
			if (this.__isRequestSuccess()) 
			{
				this.__defaultSuccessHandler(data,this.__config.dataType);
			}
			else 
			{
				this.__defaultErrorHandler(data);
			}
			this.__defaultCompleteHandler(data);
			this.__request = null;
		}
		else if (this.__request.readyState != 4 && this.__requestDone) 
		{
			console.log("Ajax Request has timed out");
			this.__request.onreadystatechange = null;
		}
	};
	
	this.__isRequestSuccess = function()
	{
		var retValue = false;
		//if requesting a local resource
		if(!this.__request.status && location.protocol == "file:")
		{
			retValue = true;
		}
		// Any status in the 200 range is good
		else if (this.__request.status >= 200 && this.__request.status < 300)
		{
			retValue = true;
		}
		//Successful if the document has not been modified and Safari returns an empty status if the file has not been modified
		else if(this.__request.status == 304 || (navigator.userAgent.indexOf("Safari") >= 0 && typeof this.__request.status == "undefined"))
		{
			retValue = true;
		}
		return retValue;
	};
	
	this.__getResponseData = function()
	{
		var contentType = this.__request.getResponseHeader("content-type");
		var data = null;
		if(contentType && contentType.indexOf("json") > -1)
		{
			data = this.__request.response;
		}
		else 
		{
			var isXMLData = false;
			var dataType = this.__requestDone.dataType;
			if(!dataType && contentType && contentType.indexOf("xml") > -1)
			{
				isXMLData = true;
			}
			if(isXMLData || (dataType && dataType.indexOf("xml") > -1))
			{
				data = this.__request.responseXML;
			}
			else
			{
				data = this.__request.responseText;
			}
			// If the specified type is "script", execute the returned text response as if it was JavaScript
			if (dataType == "script") 
			{
				eval.call(window, data);
			}
		}
		return data;
	};

	this.__getRequest = function() 
	{
		if (window.ActiveXObject)
		{
			return new ActiveXObject('Microsoft.XMLHTTP');
		}
		else if (window.XMLHttpRequest)
		{
			return new XMLHttpRequest();
		}
		return false;
	};
	
	this.__getParam = function()
	{
		var strParam = "";
		var param = this.__config.param;
		for(var paramKey in param)
		{
			if(param[paramKey])
			{
				strParam += "&" + paramKey + "=" + param[paramKey];
			}
		}
		if(strParam && strParam.length > 1)
		{
			strParam = strParam.substring(1);
		}
		return strParam;
	};
	
	this.__defaultSuccessHandler = function(response,dataType)
	{
		if(dataType === "jsonp")
		{
			 var functionName = this.__functionNameInitials + this.__random;
			 var instanceName = this.__instanceNameInitials + this.__random;
			 if(window[instanceName])
			 {
				 window[instanceName] = null;
			 }
			 if(window[functionName])
			 {
				 window[functionName] = null;
			 }
		}
		if(this.__config.successHandler)
		{
			this.__config.successHandler(response);
		}
	};
	
	this.__defaultErrorHandler = function(response)
	{
		if(this.__config.errorHandler)
		{
			this.__config.errorHandler(response);
		}
	};
	
	this.__defaultCompleteHandler = function()
	{
		if(this.__config.completeHandler)
		{
			this.__config.completeHandler();
		}
	};
	
	this.__initialize = function()
	{
		if(!this.__setting)
		{
			return;
		}
		this.__config = {
			method: this.__setting["method"] || "POST",
			url: this.__setting["url"] || "",
			param: this.__setting["param"] || {},
			dataType: this.__setting["dataType"] || "",
			successHandler: this.__setting["successHandler"] || function(){},
			errorHandler: this.__setting["errorHandler"] || function(){},
			completeHandler: this.__setting["completeHandler"] || function(){},
			timeout: this.__setting.timeout || -1
		};
		if(this.__config.dataType.toUpperCase() === "JSONP")
		{
			this.__handleJSONP();
		}
		else
		{
			if(this.__config.timeout > 0)
			{
				var ref = this;
				window.setTimeout(function() 
				{
					ref.requestDone = true;
				}, this.config.timeout);
			}
			this.__request = this.__getRequest();
			if(this.__request) 
			{
				var req = this.__request;
				var strParam = this.__getParam();
				if (this.__config.method.toUpperCase() === "POST") 
				{
					req.open("POST",this.__config.url, true);
					req.setRequestHeader("Content-type","application/x-www-form-urlencoded");
				} 
				else 
				{
					var url = this.__config.url;
					if(strParam && strParam != "")
					{
						url += "?" + strParam;
						//so that send method sends as null for GET
						strParam = null;
					}
					req.open("GET",url, true);
				}
				req.onreadystatechange = this.__bindFunction(this.__stateChange, this);
				if(this.__config.dataType)
				{
					//req.responseType = this.__config.dataType;
				}
				req.send(strParam);
			}
		}
	};
	this.__initialize();
};

NSUtil.prototype.addRemoteFileToElement = function(element,filePath)
{
	if(element && filePath)
	{
		var xmlhttp;
		if (window.XMLHttpRequest)
		{// code for IE7+, Firefox, Chrome, Opera, Safari
			xmlhttp=new XMLHttpRequest();
		}
		else
		{// code for IE6, IE5
			xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}
		xmlhttp.onreadystatechange=function()
		{
		  if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
		  {
			  element.innerHTML = xmlhttp.responseText;
		  }
		}
		xmlhttp.open("GET",filePath,true);
		xmlhttp.send();
	}
};

NSUtil.prototype.nsDragResizeElements = function(setting)
{
	this.DRAG_STARTING = "dragStaring";
	this.DRAGGING = "dragging";
	this.DRAG_END = "dragEnd";
	this.RESIZE_STARTING = "resizeStaring";
	this.RESIZING = "resizing";
	this.RESIZE_END = "resizeEnd";
	
	this.__ELEMENT_OFFSET = 4;
	
	this.__setting = setting;
	
	//Drag Variables
	this.__dragSetting = {x:0,y:0,isDragging:false};
	
	//Resize Variables
	this.__resizeSetting = {isResizing:false};
	this.__resizeDirection = {top:false,right:false,bottom:false,left:false};
	this.__dragEdge = {right:null,bottm:null};
	this.__elementRect = null;
	this.__lastElementDimension = null;
	this.__posX = null;
	this.__posY = null;
	this.__tempEvent = null;

	//Common Variables
	this.__divHidden = null;
	this.__rePaint = false;
	this.__isStopMoveOnClick = false;
	
	this.util = new NSUtil();
	
	this.__documentMouseMoveRef = null;
	this.__documentMouseUpRef = null;
	this.__documentTouchMoveRef = null;
	this.__documentTouchEndRef = null;
	this.__containerClickRef = null;
	
	this.__initialize = function() 
	{
		this.__config = {
				element: this.__setting["element"] || null,
				enableDrag: Boolean.parse(this.__setting["enableDrag"]),
				enableResize: Boolean.parse(this.__setting["enableResize"]),
				enableMoveOnClick: Boolean.parse(this.__setting["enableMoveOnClick"]),
				minWidth: this.util.getDimensionAsNumber(this.__setting["element"],this.__setting["minWidth"]),
				minHeight: this.util.getDimensionAsNumber(this.__setting["element"],this.__setting["minHeight"]),
				createGhostElementCallback: this.__setting["createGhostElementCallback"] || this.__createHiddenDiv.bind(this),
				enableDragContainment:Boolean.parse(this.__setting["enableDragContainment"]),
				container: this.__setting["container"] || document.documentElement
		};
		if(this.__config.element)
		{
			this.__divHidden = this.__config.createGhostElementCallback(this.__config.element);
			this.__initializeHiddenDiv();
			this.__addEvent();
			if(this.__config.enableDrag)
			{
				this.__initializeDrag();
			}
			if(this.__config.enableResize)
			{
				this.__initializeResize();
			}
			if(this.__config.enableMoveOnClick)
			{
				this.__initializeMoveOnClick();
			}
			this.__animateAction();
		}
	};
	
	this.stopMoveOnClick = function()
	{
		this.__isStopMoveOnClick = true;
	};
	
	this.destroy = function()
	{
		if(this.__documentMouseMoveRef)
		{
			this.util.removeEvent(document,"mousemove",this.__documentMouseMoveRef);
			this.__documentMouseMoveRef = null;
		}
		if(this.__documentMouseUpRef)
		{
			this.util.removeEvent(document,"mouseup",this.__documentMouseUpRef);
			this.__documentMouseUpRef = null;
		}
		if(this.__documentTouchMoveRef)
		{
			this.util.removeEvent(document,"touchmove",this.__documentTouchMoveRef);
			this.__documentTouchMoveRef = null;
		}
		if(this.__documentTouchEndRef)
		{
			this.util.removeEvent(document,"touchend",this.__documentTouchEndRef);
			this.__documentTouchEndRef = null;
		}
		if(this.__containerClickRef)
		{
			this.util.removeEvent(this.__config.container,"click",this.__containerClickRef);
			this.__containerClickRef = null;
		}
	};
	
	this.__addEvent = function()
	{
		this.util.addEvent(this.__config.element,"mousedown",this.__elementMouseDownHandler.bind(this));
		this.util.addEvent(this.__config.element,"touchstart",this.__elementTouchStartHandler.bind(this));
		if(!this.__documentMouseMoveRef)
		{
			this.__documentMouseMoveRef = this.__documentMouseMoveHandler.bind(this);
			this.util.addEvent(this.__config.container,"mousemove",this.__documentMouseMoveRef);
		}
		if(!this.__documentMouseUpRef)
		{
			this.__documentMouseUpRef = this.__documentMouseUpHandler.bind(this);
			this.util.addEvent(this.__config.container,"mouseup",this.__documentMouseUpRef);
		}
		if(!this.__documentTouchMoveRef)
		{
			this.__documentTouchMoveRef = this.__documentTouchMoveHandler.bind(this);
			this.util.addEvent(this.__config.container,"touchmove",this.__documentTouchMoveRef);
		}
		if(!this.__documentTouchEndRef)
		{
			this.__documentTouchEndRef = this.__documentTouchEndHandler.bind(this);
			this.util.addEvent(this.__config.container,"touchend",this.__documentTouchEndRef);
		}
	};
	
	this.__elementMouseDownHandler = function(event)
	{
		event = this.util.getEvent(event);
		this.__downActionHandler(event);
		//this.util.preventDefault(event); 
		event.stopImmediatePropagation();
	};
	
	this.__elementTouchStartHandler = function(event)
	{
		 event = this.util.getEvent(event);
		 this.__downActionHandler(event.touches[0]);
		 //this.util.preventDefault(event);
		 event.stopImmediatePropagation();
	};
	
	this.__documentMouseMoveHandler = function(event)
	{
		event = this.util.getEvent(event);
		this.__moveActionHandler(event);
		this.util.preventDefault(event); 
		event.stopImmediatePropagation();
	};
	
	this.__documentMouseUpHandler = function(event)
	{
		event = this.util.getEvent(event);
		this.__upActionHandler(event);
		this.util.preventDefault(event); 
		event.stopPropagation();
		event.stopImmediatePropagation();
	};
	
	this.__documentTouchMoveHandler = function(event)
	{
		event = this.util.getEvent(event);
		this.__moveActionHandler(event.touches[0]);
		this.util.preventDefault(event); 
		event.stopImmediatePropagation();
	};
	
	this.__documentTouchEndHandler = function(event)
	{
		event = this.util.getEvent(event);
		if (event.touches.length === 0) 
		{
			this.__upActionHandler(event.changedTouches[0]);
		}
		this.util.preventDefault(event); 
		event.stopImmediatePropagation();
	};
	
	this.__downActionHandler = function(event)
	{
		this.__setResizeVariables(event);
		var isResizing = this.__isResizeValid();
		var isDragging = !isResizing && this.__isDragValid();
		if(isResizing)
		{
			this.__startResize(event);
		}
		else if(isDragging)
		{
			this.__startDrag(event);
		}
	};
	
	this.__moveActionHandler = function(event)
	{
		this.__setResizeVariables(event);
		this.__tempEvent = event;
		this.__rePaint = true;
		if(this.__resizeSetting.isResizing) 
		{
			this.__actionResize(event);
		}
		else if(this.__dragSetting.isDragging)
		{
			this.__actionDrag(event);
		}
	};
	
	this.__upActionHandler = function(event)
	{ 
		this.__setResizeVariables(event);
		if(this.__resizeSetting.isResizing)
		{
			this.__endResize(event);
			//this.stopMoveOnClick();
		}
		else if(this.__dragSetting.isDragging)
		{
			this.__endDrag(event);
			this.stopMoveOnClick();
		}
	};
	
	/*********************************Resize Methods Starts*********************************/
	this.__initializeResize = function()
	{
	};
	
	this.__resizeElement = function()
	{
	};
	
	this.__startResize = function(event)
	{
		this.util.dispatchEvent(this.__config.element,this.RESIZE_STARTING,null,null);
		this.__resizeSetting = {
			    posX: this.__posX,
			    posY: this.__posY,
			    clientX: event.clientX,
			    clientY: event.clientY,
			    elementWidth: this.__elementRect.width,
			    elementHeight: this.__elementRect.height,
			    isResizing: true,
			    isResizeTop: this.__resizeDirection.top,
			    isResizeLeft: this.__resizeDirection.left,
			    isResizeRight: this.__resizeDirection.right,
			    isResizeBottom: this.__resizeDirection.bottom
		 };
	};
	
	this.__actionResize = function(event)
	{
		if(this.__resizeSetting.isResizeRight) 
	    {
	    	this.__config.element.style.width = Math.max(this.__posX, this.__config.minWidth) + "px";
	    }
	    if(this.__resizeSetting.isResizeBottom) 
	    {
	    	this.__config.element.style.height = Math.max(this.__posY, this.__config.minHeight) + "px";
	    }
	    if(this.__resizeSetting.isResizeLeft) 
	    {
		     var currentWidth = Math.max(this.__resizeSetting.clientX - this.__tempEvent.clientX  + this.__resizeSetting.elementWidth, this.__config.minWidth);
		     if (currentWidth > this.__config.minWidth) 
		     {
		    	 this.__config.element.style.width = currentWidth + "px";
		    	 this.__config.element.style.left = this.__tempEvent.clientX + "px";	
		     }
	    }
	    if (this.__resizeSetting.isResizeTop) 
	    {
	    	var currentHeight = Math.max(this.__resizeSetting.clientY - this.__tempEvent.clientY  + this.__resizeSetting.elementHeight, this.__config.minHeight);
		    if(currentHeight > this.__config.minHeight) 
		    {
		    	this.__config.element.style.height = currentHeight + "px";
		    	this.__config.element.style.top = this.__tempEvent.clientY + "px";	
		    }
	    }
	    this.__updateHiddenDivDimension();
	    var elementRect = this.__config.element.getBoundingClientRect();
	    this.util.dispatchEvent(this.__config.element,this.RESIZING,elementRect,{dimension:elementRect});
	};
	
	this.__endResize = function(event)
	{
		this.__resizeSetting = {isResizing:false};
		this.util.dispatchEvent(this.__config.element,this.RESIZE_END,null,null);
	};
	
	this.__setResizeVariables = function(event)
	{
		  this.__elementRect = this.__config.element.getBoundingClientRect();
		  this.__posX = event.clientX - this.__elementRect.left;
		  this.__posY = event.clientY - this.__elementRect.top;

		  this.__resizeDirection.top = this.__posY < this.__ELEMENT_OFFSET;
		  this.__resizeDirection.left = this.__posX < this.__ELEMENT_OFFSET;
		  this.__resizeDirection.right = this.__posX >= this.__elementRect.width - this.__ELEMENT_OFFSET;
		  this.__resizeDirection.bottom = this.__posY >= this.__elementRect.height - this.__ELEMENT_OFFSET;
		  
		  this.__dragEdge.right = window.innerWidth - this.__ELEMENT_OFFSET;
		  this.__dragEdge.bottom = window.innerHeight - this.__ELEMENT_OFFSET;
	};
	
	this.__isResizeValid = function()
	{
		if(this.__config.enableResize)
		{
			var retValue =  this.__resizeDirection.right || this.__resizeDirection.bottom || this.__resizeDirection.top || this.__resizeDirection.left;
			return retValue;
		}
		return false;
	};
		
	/*********************************Resize Methods Ends*********************************/
		
	/*********************************Drag Methods Starts*********************************/
	this.__initializeDrag = function()
	{
		var container = this.__config.container;
		var isContainerBody = false;
		if(container.tagName === "BODY" || container.tagName === "HTML")
		{
			isContainerBody = true;
		}
		var setPosition = function(element,rectElement)
		{
			var style = getComputedStyle(element);
			if(isContainerBody && style.position !== "absolute")
			{
				element.style.position = "absolute";
			}
			else if (style.position !== "relative" && style.position !== "absolute" ) 
			{
				element.style.position = "relative";
			}
			if(rectElement)
			{
				if(rectElement.width > 0)
				{
					element.style.width = rectElement.width + "px";
				}
				if(rectElement.height > 0)
				{
					element.style.height = rectElement.height + "px";
				}
			}
		};
		var element = this.__config.element;
		var rectElement = element.getBoundingClientRect();
		setPosition(element,rectElement);
		var rectHiddenElement = this.__divHidden.getBoundingClientRect();
		if(rectHiddenElement.width <= 0 || rectHiddenElement.height <= 0)
		{
			rectHiddenElement = rectElement;
		}
		setPosition(this.__divHidden,rectHiddenElement);
	};
	
	this.__dragElement = function()
	{
	};

	this.__startDrag = function(event)
	{
		var target = this.util.getTarget(event);
		var cancelled = this.util.dispatchEvent(this.__config.element,this.DRAG_STARTING,target,null,true,true);
		if(!cancelled)
		{
			
			this.__dragSetting.isDragging = true;
			var rectElement = this.__config.element.getBoundingClientRect();
			
			this.__dragSetting.posX = event.clientX;
			this.__dragSetting.posY = event.clientY;
			this.__dragSetting.elementTop = rectElement.top;
			this.__dragSetting.elementLeft = rectElement.left;
			this.__dragSetting.elementWidth = rectElement.width;
			this.__dragSetting.elementHeight = rectElement.height;
			this.__dragSetting.diffX = this.__dragSetting.posX - this.__dragSetting.elementLeft;
			this.__dragSetting.diffY = this.__dragSetting.posY - this.__dragSetting.elementTop;
			this.__dragSetting.containerWidth = 0;
			this.__dragSetting.containerHeight = 0;
			if(this.__config.enableDragContainment)
			{
				var containerRect = this.__config.container.getBoundingClientRect();
				this.__dragSetting.containerWidth = containerRect.width;
				this.__dragSetting.containerHeight = containerRect.height;
			}
		}
	};
	
	this.__actionDrag = function(event)
	{
		this.__setHiddenDivVisiblity(true);
		var posX = event.clientX;
        var posY = event.clientY;
        var newX = posX - this.__dragSetting.diffX;
        var newY = posY - this.__dragSetting.diffY;
        var newPosition = this.__getRestrictedPosition(newX,newY);
        this.__divHidden.style.top = newPosition.y + "px";
		this.__divHidden.style.left = newPosition.x  + "px";
		this.util.dispatchEvent(this.__config.element,this.DRAGGING,newPosition,{position:newPosition});
	};
	
	this.__endDrag = function(event)
	{
		this.__dragSetting.isDragging = false;
		this.__config.element.style.top = this.__divHidden.style.top;
		this.__config.element.style.left = this.__divHidden.style.left;
		this.__setHiddenDivVisiblity(false);
		this.__dragSetting = {x:0,y:0,isDragging:false};
		this.util.dispatchEvent(this.__config.element,this.DRAG_END,null,null);
	};
	
	this.__getRestrictedPosition = function(newX,newY)
	{
		if(this.__config.enableDragContainment)
		{
			//newX = (newX < 0) ? 0 : newX;
			//newY = (newY < 0) ? 0 : newY;
			if((newX + this.__dragSetting.elementWidth) > this.__dragSetting.containerWidth)
			{
				newX = this.__dragSetting.containerWidth - this.__dragSetting.elementWidth;
			}
			if((newY + this.__dragSetting.elementHeight) > this.__dragSetting.containerHeight)
			{
				newY = this.__dragSetting.containerHeight - this.__dragSetting.elementHeight;
			}
		}
		return {x:newX,y:newY};
	};
	
	this.__isDragValid = function()
	{
		if(this.__config.enableDrag)
		{
			var retValue = this.__posX > 0 && this.__posX < this.__elementRect.width && this.__posY > 0 && this.__posY < this.__elementRect.height && this.__posY < 30;
			return retValue;
		}
		return false;
	};
	/*********************************Drag Methods Ends*********************************/
	/*********************************Move On Click Method Starts***********************/
	this.__initializeMoveOnClick = function()
	{
		this.util.addStyleClass(this.__config.element,"nsMoveOnClick");
		this.__containerClickRef = this.__containerClickHandler.bind(this);
		this.util.addEvent(this.__config.container,"click",this.__containerClickRef);
		this.util.addEvent(this.__config.element,"click",this.__elementClickHandler.bind(this));
	};
	
	this.__elementClickHandler = function(event)
	{
		event = this.util.getEvent(event);
		this.util.preventDefault(event); 
		event.stopPropagation();
		event.stopImmediatePropagation();
	};
	
	this.__containerClickHandler = function(event)
	{
		if(!this.__isStopMoveOnClick)
		{
			event = this.util.getEvent(event);
			var element = this.__config.element;
			var parentPosition = this.__getElementPosition(event.currentTarget);
			var newX = event.clientX - parentPosition.x - (element.clientWidth / 2);
			var newY = event.clientY - parentPosition.y - (element.clientHeight / 2);
			var rectElement = this.__config.element.getBoundingClientRect();
			var containerRect = this.__config.container.getBoundingClientRect();
			var elementWidth = rectElement.width;
			var elementHeight = rectElement.height;
			var containerWidth = containerRect.width;
			var containerHeight = containerRect.height;
			newX = (newX < 0) ? 0 : newX;
			newY = (newY < 0) ? 0 : newY;
			if((newX + elementWidth) > containerWidth)
			{
				newX = containerWidth - elementWidth;
			}
			if((newY + elementHeight) > containerHeight)
			{
				newY = containerHeight - elementHeight;
			}
			element.style.left = newX + "px";
			element.style.top = newY + "px";
			this.util.preventDefault(event); 
			event.stopPropagation();
			event.stopImmediatePropagation();
		}
		this.__isStopMoveOnClick = false;
	};
	
	this.__getElementPosition = function(element) 
	{
		var position = {x:0,y:0};
		while(element) 
		{
		   if(element.tagName === "BODY" || element.tagName === "HTML") 
		   {
		      var xScroll = element.scrollLeft || document.documentElement.scrollLeft;
		      var yScroll = element.scrollTop || document.documentElement.scrollTop;
		      position.x += (element.offsetLeft - xScroll + element.clientLeft);
		      position.y += (element.offsetTop - yScroll + element.clientTop);
		   } 
		   else 
		   {
			  position.x += (element.offsetLeft - element.scrollLeft + element.clientLeft);
			  position.x += (element.offsetTop - element.scrollTop + element.clientTop);
		   }
		   element = element.offsetParent;
		}
		return position;
	};
	/*********************************Move On Click Method Ends***************************/
	/*********************************Common Methods Starts*********************************/
	this.__animateAction = function()
	{
		this.util.getRequestAnimationFrame.bind(window)(this.__animateAction.bind(this));
		if(this.__rePaint)
		{
			this.__rePaint = false;
			if(this.__resizeSetting && this.__resizeSetting.isResizing) 
			{
				this.__resizeElement();
				return;
			}
			if(this.__dragSetting && this.__dragSetting.isDragging) 
			{
				this.__dragElement();
				return;
			}
			this.__setElementCursor();
		}
	};
	
	this.__setElementCursor = function() 
	{
		if(this.__config.enableResize && this.__resizeDirection.right && this.__resizeDirection.bottom || this.__resizeDirection.left && this.__resizeDirection.top) 
		{
			 this.__config.element.style.cursor = "nwse-resize";
		} 
		else if(this.__config.enableResize && this.__resizeDirection.right && this.__resizeDirection.top || this.__resizeDirection.bottom && this.__resizeDirection.left) 
		{
			 this.__config.element.style.cursor = "nesw-resize";
		} 
		else if(this.__config.enableResize && (this.__resizeDirection.right || this.__resizeDirection.left)) 
		{
			 this.__config.element.style.cursor = "ew-resize";
		} 
		else if(this.__config.enableResize && (this.__resizeDirection.bottom || this.__resizeDirection.top)) 
		{
			 this.__config.element.style.cursor = "ns-resize";
		} 
		else if(this.__isDragValid()) 
		{
			 this.__config.element.style.cursor = "move";
		} 
		else 
		{
			 this.__config.element.style.cursor = "default";
		}
	};
	
	this.__setHiddenDivVisiblity = function(isVisible) 
	{
		this.__divHidden.style.display = (isVisible ? "" : "none");
		this.__config.element.style.display = (isVisible ? "none" : "");
	};
	
	this.__updateHiddenDivDimension = function() 
	{
		this.__updateElementDimension(this.__divHidden, this.__elementRect.left,this.__elementRect.top, this.__elementRect.width, this.__elementRect.height);
	};
	
	this.__updateElementDimension = function(element,posX,posY,width,height) 
	{
		var updateDimension = function(property,value)
		{
			(value !== -1) ? (element.style[property] = value + "px") : null;
		};
		updateDimension("left",posX);
		updateDimension("top",posY);
		updateDimension("width",width);
		updateDimension("height",height);
	};
	
	this.__createHiddenDiv = function(element)
	{
		var divHidden = this.util.createDiv(element.id + "Hidden", "nsGhostElement");
		divHidden.style.width = this.util.getStyleValue(element,"width");
		divHidden.style.height = this.util.getStyleValue(element,"height");
		
		return divHidden;
	};
	
	this.__initializeHiddenDiv = function()
	{
		if(!this.__divHidden)
		{
			this.util.throwException(1002,"Dragging Util","Function should return Ghost Element");
		}
		this.__divHidden.setAttribute("id",this.__config.element.id + "Hidden");
		var self = this;
		var setDimension = function(property)
		{
			if(!self.__config.element.style[property])
			{
				var propertyValue = self.util.getStyleValue(self.__config.element,property);
				if(propertyValue !== "auto")
				{
					self.__divHidden.style[property] = propertyValue;
				}
			}
		};
		setDimension("width");
		setDimension("height");
		this.__divHidden.style.pointerEvents = "none";
		var element = this.__config.element;
		var parentNode = element.parentNode;
		try
		{
			parentNode.appendChild(this.__divHidden);
		}
		catch(error)
		{
			this.__divHidden = this.util.getWebComponentElement(this.__divHidden);
			parentNode.appendChild(this.__divHidden);
		}
		
		this.__setHiddenDivVisiblity(false);
	};
	/*********************************Common Methods Ends*********************************/
	this.__initialize();
};

//Idea from http://stackoverflow.com/questions/4770025/how-to-disable-scrolling-temporarily
NSUtil.prototype.nsScrollEnableDisable = function(parent,orignalScrollHandler,enablerCallback)
{
	this.__parent = parent;
	this.__orignalScrollHandler = orignalScrollHandler;
	this.__enablerCallback = enablerCallback;
	 // spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36
    // left: 37, up: 38, right: 39, down: 40
	this.__scrollEventKeys = [32, 33, 34, 35, 36, 37, 38, 39, 40];
	this.__lastScrollPos = [0,0];
	
	this.util = new NSUtil();
	this.disabled = false; 
	
	this.__parentMouseWheelRef = null;
	this.__parentMouseScrollRef = null;
	this.__parentTouchMoveRef = null;
	this.__parentScrollRef = null;
	this.__documentKeyDownRef = null;
	
	this.disable = function() 
	{
		this.__lastScrollPos = [this.__parent.scrollLeft,this.__parent.scrollTop];
		this.disabled = true;
		if(this.__orignalScrollHandler)
		{
			this.util.removeEvent(this.__parent,"scroll",this.__orignalScrollHandler);
		}
		if(!this.__parentMouseWheelRef)
		{
			this.__parentMouseWheelRef = this.__handleWheel.bind(this);
			this.util.addEvent(this.__parent,"mousewheel",this.__parentMouseWheelRef);
		}
		if(!this.__parentMouseScrollRef)
		{
			this.__parentMouseScrollRef = this.__handleWheel.bind(this);
			this.util.addEvent(this.__parent,"DOMMouseScroll",this.__parentMouseScrollRef);
		}
		if(!this.__parentTouchMoveRef)
		{
			this.__parentTouchMoveRef = this.__handleWheel.bind(this);
			this.util.addEvent(this.__parent,"touchmove",this.__parentTouchMoveRef);
		}
		if(!this.__parentScrollRef)
		{
			this.__parentScrollRef = this.__handleScrollbar.bind(this);
			this.util.addEvent(this.__parent,"scroll",this.__parentScrollRef);
		}
		if(!this.__documentKeyDownRef)
		{
			this.__documentKeyDownRef = this.__handleKeydown.bind(this);
			this.util.addEvent(document,"keydown",this.__documentKeyDownRef);
		}
    };
    
    this.enable = function() 
	{
    	this.disabled = false;
    	if(this.__orignalScrollHandler)
		{
			this.util.addEvent(this.__parent,"scroll",this.__orignalScrollHandler);
		}
		if(this.__parentMouseWheelRef)
		{
			this.util.removeEvent(this.__parent,"mousewheel",this.__parentMouseWheelRef);
			this.__parentMouseWheelRef = null;
		}
		if(this.__parentMouseScrollRef)
		{
			this.util.removeEvent(this.__parent,"DOMMouseScroll",this.__parentMouseScrollRef);
			this.__parentMouseScrollRef = null;
		}
		if(this.__parentTouchMoveRef)
		{
			this.util.removeEvent(this.__parent,"touchmove",this.__parentTouchMoveRef);
			this.__parentTouchMoveRef = null;
		}
		if(this.__parentScrollRef)
		{
			this.util.removeEvent(this.__parent,"scroll",this.__parentScrollRef);
			this.__parentScrollRef = null;
		}
		if(this.__documentKeyDownRef)
		{
			this.util.removeEvent(document,"keydown",this.__documentKeyDownRef);
			this.__documentKeyDownRef = null;
		}
    };
	
	this.__handleWheel = function(event) 
	{
		event = this.util.getEvent(event);
        event.preventDefault();
    };
	
	this.__handleScrollbar = function(event) 
	{
		event = this.util.getEvent(event);
        this.__parent.scrollLeft = this.__lastScrollPos[0];
        this.__parent.scrollTop = this.__lastScrollPos[1];
        if(this.__enablerCallback && this.__enablerCallback(event))
        {
        	this.enable();
        }
    };
	
	this.__handleKeydown = function(event) 
	{
		event = this.util.getEvent(event);
        for (var count = 0; count < this.__scrollEventKeys.length; count++) 
		{
            if (event.keyCode === this.__scrollEventKeys[count]) 
			{
                event.preventDefault();
                return;
            }
        }
    };
};

//Idea from http://stackoverflow.com/questions/10344498/best-way-to-iterate-over-an-array-without-blocking-the-ui
NSUtil.prototype.processArrayAsync = function(array,callBack,maxTimePerChunk,completeHandler,context) 
{
	this.__array = array;
	this.__callBack = callBack;
	this.__maxTimePerChunk = maxTimePerChunk || 50;
	this.__completeHandler = completeHandler;
    this.__context = context || window;
    this.__index = 0;
    
    this.util = new NSUtil();
    this.__requestId = null;
    this.__hasPaused = false;
    this.__hasCompleted = false;
    
    this.start = function(startIndex)
    {
    	this.__index = startIndex || 0;
    	this.__hasPaused = false;
    	this.__process();
    };
    
    this.stop = function()
    {
    	this.__hasPaused = true;
    	if(this.__requestId)
    	{
    		window.cancelAnimationFrame(this.__requestId);
    		//this.util.getCancelAnimationFrame.bind(window)(this.__requestId);
    		this.__requestId = null;
    	}
    };
    
    this.resume = function()
    {
    	this.__hasPaused = false;
    	if(!this.__hasCompleted)
    	{
    		this.__process();
    	}
    };
    
    this.__process = function() 
    {
    	if(!this.__hasPaused)
    	{
    		var startTime = this.__getCurrentTime();
            while(this.__index < this.__array.length && (this.__getCurrentTime() - startTime) <= this.__maxTimePerChunk) 
            {
            	this.__callBack.bind(this.__context)(this.__array[this.__index], this.__index, this.__array);
                ++this.__index;
            }
            if(this.__index < this.__array.length) 
            {
                // set Timeout for async iteration
            	this.__requestId = this.util.getRequestAnimationFrame.bind(window)(this.__process.bind(this));
            }
            else if(this.__completeHandler)
            {
            	this.__completeHandler.bind(this.__context)();
            	this.__hasCompleted = true;
            }
    	}
    };
    
    this.__getCurrentTime = function()
    {
        return new Date().getTime();
    };
};

NSUtil.prototype.image = function()
{
	this.getMoveIcon = function(toolTip)
	{
		return this.__createImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAoZJREFUeNpsU81rE0EUf7uzu2lNVJL6Eb0IBWusepqcKm3wEFkvxqDgQbwUtYeeg5cccwj4F7QKChEPipRcdMGDiaAoJAexLYViwYsfbU1JYkx3Zz98b8220Wbg7ez7vXm/mffmN9Kh1G2QGQOmMDiRyYEkSaCoKjDGdAAooOUdxzFsIcDzPPhSvgeO7YDrOLBRmQdlJHULVE0DNRSCvqFjUuHqhWP8+etvhR5m0CeengVhmiAsywdl2Dt03K1wZSrO220XaCaf8AFrQel32s0mrDcaWfovrq3Vc9OTvHj/Tb0Xzh6JxQwNyxtIgPXpqqJk94fDM+1Oh6CaEF4QTiIOGJ/DdQtBObsEmGxbll/rkCyDPDwMzW4XhHD88EH0NcRxDUeX4/qdnsi0s8Aas+kEp8Zg82pMkmpDigKbjSbQTD7hFL94/jin9ZRHBNLo3Wrt+uUkbzQsiEZVMPGKfv76DaawodnahkhY86+PNnXxs77ZgVOjMahWVuufi1NJRZhWvvT0beHGtQn++Nm7en+DzqXO8vfVxX+wsYnT/JWxWEe95P0eILsvkkdPKn4PUEBJmunILab5992PLVU++skoNmOniT7JX2Fkt5GM1EjqbMohXzQmqo7KwCQ6zYKiabu30PpQAnZ0HKSRMcMRwnBddw4ZOO4GLRYKFFdDhrrteTMMdWB9/QTdH8sIp0EKmNT4GWDjGZAPJ3TcrbBv+ibfwtwDqBvzYck/truxYjjLZRDflwLt7JUmEoAymdPV7INa5IXn0Uw+4f8PIqATMLQIWpQ0E/RFTmQ4nLx0B1Zfzrsr5eAmbLQW2hYpHwkcqfegNBJhzwY9sGC4aCZaF81CAvePAAMAcwtApJX/Wo0AAAAASUVORK5CYII=',toolTip);
	};
	
	this.getLeftIcon = function(toolTip)
	{
		return this.__createImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAe9JREFUeNqkUz1oE2EYfu7uuyRKLCFt6g+4VNQWWod+mQRRR1En0UFOHKoNCMKNju4SEQsOzsFNcRGl4CS42AzaKhKcsqhk0Etj7u+773y/6+USbOLSF5574b33eX+e906L4xh7MaYeC/c/IFcowMznEzDTBGPMoldnqEFtkPy708mIqvHHe0s7BcaYJYSwRwPu9vbYRH1XJI4tEYb2jYtHOHko9LvdxE9cYZQcBoF9+9oJ7jgRQt+HFAJSyv9rkO6UkGvXF3mr9QelkpkUINsYR6T8Jrkay8i+b9+5yfnmppMmSFw6e4yrIynBBsdS3jQ1PH/zeTiBIt+9dZpvbTlZh1+Oh/Z3F33XRUj7R1GUxA3DwMx0EYHnDUUMPe9Rfe1tc26uiL6M8aXno+UH6O7PIShPIapMQx6sQMxW4JbL+MkKCKhwNgGN2FD7Pnz82j63coF/aoc4ekDHtxfrzUniaZrW/FfEBomI9Scv7fnVq7zdBwIqajBWpeTd99d3vgBNCaQSzMOLyJ+6ApSPWxSzD61a/MfThupSjVuvxk2A3sazYYGBGbML0OcvW9rMyeRLFO8eVGXnKyacMiug5ikSplLs05dXzqNQWpbv6/URjpK+m6JH3GhQQI2QI+RTmBO0EwQ/RUBcqe31d/4rwAB0lPTXqN6HzgAAAABJRU5ErkJggg==',toolTip);
	};
	
	this.getRightIcon = function(toolTip)
	{
		return this.__createImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAfBJREFUeNqkUz1s00AU/hwSh1SEhiFCYuhCVSExgHRiYKjEVCEyMMGAsjCxZunesWM7dIgEA8JISPyoUhFDFoZOSE2GgtrSIAYWSEPb1HUS23c+8+7iuE5/JKQ+6fOdz/e+970fG2EY4jyWVo9b819hGEZ8WCgW4z2dV2lZFUJYgnNwz9PwXRebc3cGBMfN6XSQy+eHryyCMuv43dRpBCpSz7b1qlB+cI3RWkEYlv+LQFkgBLxuV8s9OAhQLk0w7vsnSHQKVMhqQuYRSRBouK5AqyXwpHSdvfywUYkKb8UEFIU9fXybOY6A+jbszGAP7O/7RBKg2eR4dH+KvV5ej0k0gaqobXO0214c3acUDnt99Pp9cKqDUqLsx68LuHd3gtU+b1eOCOiSaaZQKJjgMsSOy7EnJcSYCZnLwKbojic1weTVMXz81KhTexeSKdSXqrUzh2X84Qxr9SQmx1P48q6mnTPZrJUs4jMp5QlHlSd1Y203fRGFK8DPV28HzqZpjXShW3+D00bamCrpNU9DuvvcGsjea1rO+nvw39+AxRCGckyO8ciQFG8gPT27ptX8/b4gt1asYGdzRGE6MVCXCJcj5NShbG9B/NnYhttpyMYL5XmTYEdw1KgMFSgJJiEbIXNGPQXBi+CTrzTO+zv/E2AA3Y8Nbp4Kn1sAAAAASUVORK5CYII=',toolTip);
	};
	
	this.__createImage = function(source,toolTip)
	{
		if(source)
		{
			var img = document.createElement('img');
			img.setAttribute("src",source);
			if(toolTip)
			{
				img.setAttribute("title",toolTip);
			}
	        return img;
		}
		return null;
	};
};

NSUtil.prototype.localStorage = function()
{
	this.util = new NSUtil();
	this.STORAGE_PREFIX = "nsStorage";
	this.setData = function(key,data) 
	{
	    if (this.isAPISupported() && key) 
	    {
	    	var calcKey = this.__getKey(key);
	    	var item = data;
	    	this.removeData(calcKey);
	    	if(item && !this.util.isString(item) && this.__isJSONSupported())
	    	{
	    		item = JSON.stringify(item);
	    	}
	    	localStorage.setItem(calcKey,item);
	    	return true;
	    }
	    return false;
	};
	
	this.getData = function(key) 
	{
		if (this.isAPISupported() && key) 
		{
			var item = localStorage.getItem(this.__getKey(key));
		    if (item) 
		    {
		    	if(this.__isJSONSupported())
		    	{
		    		return JSON.parse(item);
		    	}
		    	else
		    	{
		    		return item;
		    	}
		    	
		    }
	    }
	    return null;
	};
	
	this.removeData = function(key) 
	{
		if (this.isAPISupported() && key) 
		{
			localStorage.removeItem(this.__getKey(key));
			return true;
	    }
		return false;
	};
	
	this.removeAll = function()
	{
		if (this.isAPISupported()) 
		{
			var callBack = function(key)
			{
				this.removeData(key);
			};
			this.__manipulateAllKeys(callBack.bind(this));
		}
	};
	
	this.isAPISupported = function()
	{
		if (!window.localStorage || !window.JSON) 
		{
	        return false;
	    }
		 return true;
	};
	
	this.__isJSONSupported = function()
	{
		if (!window.JSON) 
		{
	        return false;
	    }
		 return true;
	};
	
	this.__manipulateAllKeys = function(callBack) 
	{
		if(callBack)
		{
			var keyRegex = new RegExp("^" + this.STORAGE_PREFIX + "(.*)");
			for (var count = localStorage.length-1; count >= 0 ; --count) 
			{
			      var key = localStorage.key(count);
			      key = key && key.match(keyRegex);
			      key = key && key[1];
			      if (key && key.indexOf(this.STORAGE_PREFIX) < 0) 
			      {
			    	  callBack(key);
			      }
			}
		}
	};
	
	this.__getKey = function(key)
	{
		return (this.STORAGE_PREFIX + key);
	};
};

NSUtil.prototype.replaceHTMLFromObject = function(config,doc)
{
	this.__config = config;
	this.__setting = {};
	this.__doc = doc;
	
	this.util = new NSUtil();
	this.__regex = "([\\w\\.\\^]+)";
	this.__regexString = null;
	
	this.__initialize = function()
	{
		if(!this.__config)
		{
			this.__config = {};
		}
		this.__setting = 
		{
			startSeparatorTag : (this.__config.startSeparatorTag) ? this.__config.startSeparatorTag : "{{",
			endSeparatorTag : (this.__config.endSeparatorTag) ? this.__config.endSeparatorTag : "}}"
		};
		if(!this.__doc)
		{
			this.__doc = document;
		}
		this.__regexString = this.__setting.startSeparatorTag + this.__regex + this.__setting.endSeparatorTag;
	};
	
	this.replace = function(template,data,parent,isPureHTML) 
	{
		var retHTML = "";
		if(template && data)
		{
			isPureHTML = Boolean.parse(isPureHTML);
			var innerHTML = "";
			if(isPureHTML)
			{
				innerHTML = template;
			}
			else if(this.util.isString(template))
			{
				var element = this.__doc.querySelector("#" + template);
				if(element)
				{
					innerHTML = element.innerHTML;
				}
			}
			else if(this.util.isElement(template))
			{
				template = template.innerHTML;
			}
			else
			{
				innerHTML = template;
			}
			var length = data.length;
			for (var count = 0;count < length; count++) 
			{
				retHTML += this.__replaceWithItem(data[count],innerHTML);
		    }
			if(parent)
			{
				if(this.util.isString(parent))
				{
					var element = this.__doc.querySelector("#" + parent);
					if(element)
					{
						parent = element;
					}
				}
				if(parent)
				{
					parent.innerHTML += retHTML;
				}
			}
		}
		return retHTML;
	};
	
	this.__replaceWithItem = function(item,htmlText)
	{
		var html = null;
        for (prop in item) 
        {
            var regex = new RegExp(this.__setting.startSeparatorTag + prop + this.__setting.endSeparatorTag,"g");
            html = (html || htmlText).replace(regex, item[prop]);
        }
        return html;
	};
	
	this.__initialize();
};

NSUtil.prototype.nsPopUp = function(config)
{
	this.__config = config;
	this.__setting = {};
	this.__popUp = null;
	this.__documentClickHandlerRef = null;
	this.util = new NSUtil();
	
	this.create = function (dataSource) 
	{ 
		this.__createElement();
		return this.__popUp;
	};

	this.remove = function() 
	{
		if(this.__popUp)
		{
			this.__popUp.parentNode.removeChild(this.__popUp);
			this.__popUp = null;
			if(this.__documentClickHandlerRef)
			{
				this.util.removeEvent(document,"click",this.__documentClickHandlerRef);
				this.__documentClickHandlerRef = null;
			}
		}
	};

	this.show = function() 
	{
		if(this.__popUp)
		{
			this.util.addStyleClass(this.__popUp,"nsShowPopUp");
		}
	};

	this.hide = function() 
	{
		if(this.__popUp)
		{
			this.util.removeStyleClass(this.__popUp,"nsShowPopUp");
		}
	};
	
	this.placePopUp = function(event)
	{
		if(this.__popUp)
		{
			var position = this.__setting["position"];
			position = this.__getSuggestedPosition(event,position);
			var offset = this.__getOffset(event,position);
			this.__popUp.style.top = offset.top + "px";
			this.__popUp.style.left = offset.left + "px";
		}
	};
	
	this.hideOtherNSPopUp = function()
	{
		var arrMenus = document.querySelectorAll(".nsPopUp");
		if(arrMenus && arrMenus.length > 0)
		{
			var menu = null;
			for(var count = 0;count < arrMenus.length;count++)
			{
				menu = arrMenus[count];
				this.util.removeStyleClass(menu,"nsShowPopUp");
			}
		}
	};
	
	this.getPopUp = function()
	{
		return this.__popUp;
	};
	
	this.__initialize = function()
	{
		if(!this.__config)
		{
			this.__config = {};
		}
		this.__setting = 
		{
			id: this.__config["id"] || null,
			type: this.__config["type"] || "div",
			parent: this.__config["parent"] || document.body,
			width: parseInt(this.__config["width"]) || -1,
			position: this.__config["position"] || this.util.POS_BOTTOMRIGHT,
			closeOnOutsideClick: Boolean.parse(this.__config["closeOnOutsideClick"])
		};
	};
	
	this.__createElement = function() 
	{
		if(this.__popUp)
		{
			this.remove();
		}
		this.__popUp = document.createElement(this.__setting["type"]); 
		if(this.__setting["id"])
		{
			this.__popUp.setAttribute("id",this.__setting["id"]);
		}
		this.util.addStyleClass(this.__popUp,"nsPopUp");
		if(this.__setting.width > -1)
		{
			this.__popUp.style.width = this.__setting.width + "px";
		}
		if(this.__setting["closeOnOutsideClick"])
		{
			this.util.addEvent(this.__popUp,"click",this.__popUpClickHandler.bind(this));
			if(!this.__documentClickHandlerRef)
			{
				this.__documentClickHandlerRef = this.__documentClickHandler.bind(this);
				this.util.addEvent(document,"click",this.__documentClickHandlerRef);
			}
		}
		this.__setting["parent"].appendChild(this.__popUp);
	};
	
	this.__popUpClickHandler = function(event)
	{
		event.stopPropagation();
	};
	
	this.__documentClickHandler = function(event)
	{
		this.remove();
	};

	this.__getOffset = function(event,position)
	{
		  var rectPopUp = this.__popUp.getBoundingClientRect();
		  var item = {top: 0,left:0};
		  if(rectPopUp)
		  {
			  var popUpWidth = rectPopUp.width;
			  var popUpHeight = rectPopUp.height;
			  var offset = this.util.getEventPosition(event);
			  switch(position) 
			  {
				case this.util.POS_TOP:
					item.top = offset.top - popUpHeight;
					item.left = offset.left - popUpWidth / 2;
					break;
				case this.util.POS_BOTTOM:
					item.top = offset.top;
					item.left = offset.left - popUpWidth / 2;
					break;
				case this.util.POS_LEFT:
					item.top =  offset.top - popUpHeight / 2;
					item.left = offset.left - popUpWidth;
					break;
				case this.util.POS_RIGHT:
					item.top =  offset.top - popUpHeight / 2,
					item.left = offset.left;
					break;
				case this.util.POS_TOPLEFT:
					item.top = offset.top - popUpHeight;
					item.left = offset.left - popUpWidth;
					break;
				case this.util.POS_TOPRIGHT:
					item.top =  offset.top - popUpHeight;
					item.left = offset.left;
					break;
				case this.util.POS_BOTTOMLEFT:
					item.top =  offset.top;
					item.left = offset.left - popUpWidth;
					break;
				case this.util.POS_BOTTOMRIGHT:
					item.top =  offset.top;
					item.left = offset.left;
					break;
			  }
		  }
		  return item;
	};

	this.__getSuggestedPosition = function(event,position)
	{
		  event = this.util.getEvent(event);
		  var popUpWidth = this.__popUp.clientWidth;
		  var popUpHeight = this.__popUp.clientHeight;
		  var offset = this.util.getEventPosition(event);
		  var top = window.scrollY;
		  var left = window.scrollX;
		  var totalWidth = window.innerWidth;
		  var totalHeight = window.innerHeight;
		
		  var objPosition = {};
		  objPosition[this.util.POS_TOP] = true;
		  objPosition[this.util.POS_BOTTOM] = true;
		  objPosition[this.util.POS_LEFT] = true;
		  objPosition[this.util.POS_RIGHT] = true;
		  if (offset.top < top) 
		  {
			  objPosition[this.util.POS_TOP] = false;
		  }
		  if (offset.top + popUpHeight > top + totalHeight) 
		  {
			  objPosition[this.util.POS_BOTTOM] = false;
		  }
		  if (offset.left < left)
		  {
			  objPosition[this.util.POS_LEFT] = false;
		  }
		  if (offset.left + popUpWidth > left + totalWidth) 
		  {
			  objPosition[this.util.POS_RIGHT] = false;
		  }
		
		  var positions = position.split("-");
		  //below loop tries to give favourable position like bottom-right so if position has bottom and right both true it returns that position
		  for (var count = 0; count < positions.length; count++) 
		  {
			if (!objPosition[positions[count]]) 
			{
				break;
			}   
			if (count === positions.length - 1) 
			{
			  return position;
			}
		  }
		  //below loop tries to give one favourable position like in bottom-right if bottom is true or right is true it gets returned
		  for (var count = 0; count < positions.length; count++) 
		  {
			if (objPosition[positions[count]]) 
			{
				return positions[count];
			}
		  }
		  if (objPosition[position]) 
		  {
			  return position;
		  }
		  for(var tmpPosition in objPosition)
		  {
			  if (objPosition[tmpPosition]) 
			  {
				  return tmpPosition;
			  }
		  }
	};
	this.__initialize();
};

NSUtil.prototype.nsToolTipInElement = function()
{
	this.util = new NSUtil();
	this.__nsToolTip = null;
	this.__nsToolTipContent = null;
	this.__documentClickHandlerRef = null;
	
	this.addToolTip = function(element,toolTipHTML)
	{
		element = this.util.getElement(element);
		if(element && toolTipHTML && toolTipHTML.length > 0)
		{
			this.__createToolTip();
			this.util.addStyleClass(element,"nsElementTooltip");
			element.setAttribute("nsToolTip",toolTipHTML);
			this.util.addEvent(element,"mouseover",this.__elementMouseOverHandler.bind(this));
			this.util.addEvent(element,"mouseout",this.__elementMouseOutHandler.bind(this));
		}
	};
	
	this.__createToolTip = function()
	{
		if(!this.__nsToolTip)
		{
			var id = "nsElementToolTip" + this.util.getUniqueId();
			this.__nsToolTip = this.util.createElement("span",id + "ElementTooltipContainer", "nsElementTooltipContainer");
			var arrow = this.util.createElement("span",id + "ElementTooltipArrow", "nsElementTooltipTipArrow");
			this.__nsToolTip.appendChild(arrow);
			this.__nsToolTipContent = this.util.createElement("span",id + "ElementTooltipContent", "nsElementTooltipContent");
			this.__nsToolTip.appendChild(this.__nsToolTipContent);
			document.body.appendChild(this.__nsToolTip);
			if(!this.__documentClickHandlerRef)
			{
				this.__documentClickHandlerRef = this.__documentClickHandler.bind(this);
				this.util.addEvent(document,"click",this.__documentClickHandlerRef);
			}
		}
	};
	
	this.__elementMouseOverHandler = function(event)
	{
		event = this.util.getEvent(event);
		var target = this.util.getTarget(event);
		if(!this.util.hasStyleClass(target, "nsElementTooltip"))
		{
			target = this.util.findParentBySelector(target,".nsElementTooltip");
		}
		if(target)
		{
			var toolTipHTML = target.getAttribute("nsToolTip");
			//var parentWithScroll = 
			this.__nsToolTipContent.innerHTML = toolTipHTML;
			var offset = this.util.getEventPosition(event);
			this.__nsToolTip.style.left = offset.left + "px";
			this.__nsToolTip.style.top = offset.top + "px";
			this.util.addStyleClass(this.__nsToolTip,"nsElementTooltipContainerVisible");
		}
	};
	
	this.__elementMouseOutHandler = function(event)
	{
		this.util.removeStyleClass(this.__nsToolTip,"nsElementTooltipContainerVisible");
	};
	
	this.__documentClickHandler = function(event)
	{
		this.__elementMouseOutHandler();
	};
};

NSUtil.prototype.nsCSSAnimationHelper = function()
{
	this.util = new NSUtil();
	this.__prefixes = ["webkit", "moz", "MS", "o", ""];
	
	this.addStartEvent = function(element,callback)
	{
		this.__addEvent(element,"AnimationStart",callback);
	};
	
	this.addIterationEvent = function(element,callback)
	{
		this.__addEvent(element,"AnimationIteration",callback);
	};
	
	this.addEndEvent = function(element,callback)
	{
		this.__addEvent(element,"AnimationEnd",callback);
	};
	
	this.removeStartEvent = function(element,callback)
	{
		this.__removeEvent(element,"AnimationStart",callback);
	};
	
	this.removeIterationEvent = function(element,callback)
	{
		this.__removeEvent(element,"AnimationIteration",callback);
	};
	
	this.removeEndEvent = function(element,callback)
	{
		this.__removeEvent(element,"AnimationEnd",callback);
	};
	
	this.__addEvent = function(element,type,callback) 
	{
	    for (var count = 0; count < this.__prefixes.length; count++) 
	    {
	        if (!this.__prefixes[count])
	        {
	        	type = type.toLowerCase();
	        }
	        var eventType = this.__prefixes[count] + type;
	        this.util.addEvent(element,eventType,callback);
	    }
	};
	
	this.__removeEvent = function(element,type,callback) 
	{
	    for (var count = 0; count < this.__prefixes.length; count++) 
	    {
	        if (!this.__prefixes[count])
	        {
	        	type = type.toLowerCase();
	        }
	        var eventType = this.__prefixes[count] + type;
	        this.util.removeEvent(element,eventType,callback);
	    }
	};
};


NSUtil.prototype.nsResizeListener = function()
{
	this.util = new NSUtil();
	this.__windowResizeRef = null;
	this.addResizeListener = function(element, callback) 
	{
		if(this.__isMutationSupported()) 
		{
			function getParameter() 
			{
			    return [element.style.width, element.style.height, element.clientWidth, element.clientHeight].join('')
			}
			var resizeCallback = function(event)
			{
				var current = getParameter(element);
				if (current !== last) 
				{
					last = current;
					callback.call(element, event);
					return true;
				}
				return false;
			};
			var last = getParameter(element)
			var observer = new MutationObserver(function (mutations) 
			{
				for (var count = 0; count < mutations.length; count++) 
				{
				    var mutation = mutations[count];
				    if (mutation.attributeName !== "style")
				    {
				    	continue;
				    }
				    if(resizeCallback())
				    {
				    	  break;
				    }
			    }
			});
			observer.observe(element,{
			    attributes: true,
			    childList: false,
			    characterData: false
			});
			if(!this.__windowResizeRef)
			{
				this.__windowResizeRef = resizeCallback.bind(this);
				this.util.addEvent(window,"resize",this.__windowResizeRef);
			}
		}
		else
		{
			if (!element.__resizeListeners__) 
	        {
	            element.__resizeListeners__ = [];
	            if (document.attachEvent) 
	            {
	                element.__resizeTrigger__ = element;
	                element.attachEvent('onresize', this.__resizeListener.bind(this));
	            } 
	            else 
	            {
	                if (getComputedStyle(element).position === 'static') 
	                {
	                	element.style.position = 'relative';
	                }
	                var obj = element.__resizeTrigger__ = document.createElement('object');
	                this.util.addStyleClass(obj,"nsResizeDetector");
	                obj.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;');
	                obj.__resizeElement__ = element;
	                obj.onload = this.__objectLoad.bind(this);
	                obj.type = 'text/html';
	                var isIE = navigator.userAgent.match(/Trident/);//this.util.isBrowserIE();
	                if(isIE) 
	                {
	                	element.appendChild(obj);
	                }
	                obj.data = 'about:blank';
	                if(!isIE) 
	                {
	                	element.appendChild(obj);
	                }
	            }
	        }
	        element.__resizeListeners__.push(callback);
		}
    };
    //below method will not work as we have to store the reference and then detach it
    this.removeResizeListener = function(element, callback) 
    {
    	if(this.__isMutationSupported())
    	{
    		if(this.__windowResizeRef)
			{
    			this.util.removeEvent(window,"resize",this.__windowResizeRef);
    			this.__windowResizeRef = null;
			}
    	}
    	else
    	{
    		element.__resizeListeners__.splice(element.__resizeListeners__.indexOf(callback), 1);
            if (!element.__resizeListeners__.length) 
            {
                if (attachEvent) 
                {
                	element.detachEvent('onresize', this.__resizeListener.bind(this));
                }
                else 
                {
                    element.__resizeTrigger__.contentDocument.defaultView.removeEventListener('resize', this.__resizeListener.bind(this));
                    element.__resizeTrigger__ = !element.removeChild(element.__resizeTrigger__);
                }
            }
    	}
    };
    
    this.__resizeListener = function(event) 
    {
    	var requestAnimation = function()
    	{
    		 var trigger = win.__resizeTrigger__;
             trigger.__resizeListeners__.forEach(function (callback) 
             {
                 callback.call(trigger, event);
             });
    	};
    	var win = this.util.getTarget(event);
        if (win.__resizeRAF__) 
        {
        	this.util.getCancelAnimationFrame.bind(window)(win.__resizeRAF__);
        }
        win.__resizeRAF__ = this.util.getRequestAnimationFrame.bind(window)(requestAnimation.bind(this));
    };

    this.__objectLoad = function(event) 
    {
    	var target = this.util.getTarget(event);
    	target.contentDocument.defaultView.__resizeTrigger__ = target.__resizeElement__;
    	target.contentDocument.defaultView.addEventListener('resize', this.__resizeListener.bind(this));
    };
    
    this.__isMutationSupported = function()
    {
    	return ("MutationObserver" in window);
    };
};
