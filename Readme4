this.__enableMultiCellSelection = false;
	this.__tableCellNavigatorEventRef = null;
	this.__tableCellSelectionEventRef = null;
	this.__nsTableCellNavigator = null;
	this.__nsCellSelection = null;
	this.__multiCellSelectionSetting = null;
			if(this.hasAttribute("enableMultiCellSelection"))
		{
			this.__enableMultiCellSelection =  Boolean.parse(this.getAttribute("enableMultiCellSelection"));
		}
		
				if(this.hasAttribute("multiCellSelectionSetting"))
		{
			this.__multiCellSelectionSetting = this.getAttribute("multiCellSelectionSetting");
		}
		else
		{
			this.__multiCellSelectionSetting = {scrollableElement:null,enableFillHandle:false,enableKeyboardNavigation:true,enableCopy:true,enablePaste:true,cellClass:null,areaClass:null,areaClassLeft:null,areaClassRight:null,areaClassTop:null,areaClassBottom:null};
		}
		
		if(this.__enableCellSelection)
	{
		if(this.__nsTableCellNavigator)
		{
			this.__nsTableCellNavigator.destroy();
			if(this.__tableCellNavigatorEventRef)
			{
				this.util.removeEvent(self.__tblCenterBody,NSTableCellNavigator.CELL_SELECTED,this.__tableCellNavigatorEventRef);
				this.util.removeEvent(self.__tblCenterBody,NSTableCellNavigator.CELL_UNSELECTED,this.__tableCellNavigatorEventRef);
				this.util.removeEvent(self.__tblCenterBody,NSTableCellNavigator.CELL_SELECTABLE,this.__tableCellNavigatorEventRef);
				this.__tableCellNavigatorEventRef = null;
			}
			this.__nsTableCellNavigator = null;
		}
		this.__nsTableCellNavigator = new NSTableCellNavigator(self.__tblCenterBody);
		this.__tableCellNavigatorEventRef = this.__tableCellNavigatorEventHandler.bind(this);
		this.util.addEvent(self.__tblCenterBody,NSTableCellNavigator.CELL_SELECTED,this.__tableCellNavigatorEventRef);
		this.util.addEvent(self.__tblCenterBody,NSTableCellNavigator.CELL_UNSELECTED,this.__tableCellNavigatorEventRef);
		this.util.addEvent(self.__tblCenterBody,NSTableCellNavigator.CELL_SELECTABLE,this.__tableCellNavigatorEventRef);
	}
	if(this.__enableMultiCellSelection)
	{
		if(this.__nsCellSelection)
		{
			this.__nsCellSelection.destroy();
			if(this.__tableCellSelectionEventRef)
			{
				this.util.removeEvent(self.__tblCenterBody,NSCellSelection.SELECTION_START,this.__tableCellSelectionEventRef);
				this.util.removeEvent(self.__tblCenterBody,NSCellSelection.SELECTION_END,this.__tableCellSelectionEventRef);
				this.util.removeEvent(self.__tblCenterBody,NSCellSelection.SET_CELL_VALUE,this.__tableCellSelectionEventRef);
				this.__tableCellSelectionEventRef = null;
			}
			this.__nsCellSelection = null;
		}
		var editors = [];
		for (var colIndex = 0; colIndex < this.__columns.length; colIndex++)
	    {
			var colItem = this.__columns[colIndex];
			if(colItem["multiSelectionEditor"])
			{
				editors.push({type:NSCellSelection.EDITORS[colItem["multiSelectionEditor"]]});
			}
			else
			{
				editors.push({type:NSCellSelection.EDITORS[NSGrid.MULTI_SELECTION_EDITORS_TEXT]});
			}
	    }
		var setting = this.__multiCellSelectionSetting; 
		setting.editors = editors;
		this.__nsCellSelection = new NSCellSelection(self.__tblCenterBody,setting);
		this.__tableCellSelectionEventRef = this.__tableCellSelectionEventHandler.bind(this);
		this.util.addEvent(self.__tblCenterBody,NSCellSelection.SELECTION_START,this.__tableCellSelectionEventRef);
		this.util.addEvent(self.__tblCenterBody,NSCellSelection.SELECTION_END,this.__tableCellSelectionEventRef);
		this.util.addEvent(self.__tblCenterBody,NSCellSelection.SET_CELL_VALUE,this.__tableCellSelectionEventRef);
	}

NSGrid.prototype.__tableCellNavigatorEventHandler = function(event)
{
	switch(event.type)
	{
		case NSTableCellNavigator.CELL_SELECTED:
			var cell = event.cell;
			this.util.addStyleClass(cell,"nsCellFocus");
			var row = event.row;
		    var rowIndex = this.__getIndexFromRow(row);
		    var item = this.__getItemByIndex(rowIndex);
		    this.__dispatchEvent(NSGrid.CELL_SELECTED,item,{cellIndex:event.cellIndex,rowIndex:rowIndex,item:item,cell:cell,row:row});
		break;
		case NSTableCellNavigator.CELL_UNSELECTED:
			var cell = event.cell;
			this.util.removeStyleClass(cell,"nsCellFocus");
			var row = event.row;
			var rowIndex = this.__getIndexFromRow(row);
			var item = this.__getItemByIndex(rowIndex);
			this.__dispatchEvent(NSGrid.CELL_UNSELECTED,item,{cellIndex:event.cellIndex,rowIndex:rowIndex,item:item,cell:cell,row:row});
		break;
		case NSTableCellNavigator.CELL_SELECTABLE:
			//var cell = event.cell;
			//var row = event.row;	
		break;
	}
};

NSGrid.prototype.__tableCellSelectionEventHandler = function(event)
{
	switch(event.type)
	{
		case NSCellSelection.SELECTION_START:
			console.debug("Selection Started");
		break;
		case NSCellSelection.SELECTION_END:
			console.debug("Selection Ended with cells " + event.selectedCells);
		break;
		case NSCellSelection.SET_CELL_VALUE:
			var cellIndex = event.cellIndex;
			var cell = event.cell;
			var row = event.row;
			var dataToBeSet = event.dataToBeSet;
			var rowIndex = this.__getIndexFromRow(row);
			var item = this.__getItemByIndex(rowIndex);
			if(this.__tblCenterHeader.tBodies && this.__tblCenterHeader.tBodies.length > 0 && this.__tblCenterHeader.tBodies[0].rows && this.__tblCenterHeader.tBodies[0].rows.length > 0)
			{
				var headerCell = this.__tblCenterHeader.tBodies[0].rows[0].cells[cellIndex];
				var columnDetail = this.__getColumnObject(headerCell.getAttribute("currentColumnIndex"));
				if(item && columnDetail)
				{
					item[columnDetail["dataField"]] = dataToBeSet;
					this.updateItemInDataSource(item);
					this.__updateCellText(row,cell,item,columnDetail,rowIndex,columnDetail[self.__fieldColIndex]);
				}
			}	
		break;
	}
};

NSGrid.MULTI_SELECTION_EDITORS_TEXT = "TEXT";
NSGrid.MULTI_SELECTION_EDITORS_TEXTAREA = "TEXTAREA";
